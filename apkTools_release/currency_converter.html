<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, .3);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      padding: 40px 30px;
      text-align: center;
      position: relative;
    }

    .home-btn {
      position: absolute;
      top: 20px;
      left: 20px;
      width: 44px;
      height: 44px;
      background: rgba(255, 255, 255, 0.15);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      text-decoration: none;
      font-size: 20px;
      transition: all .3s;
      z-index: 10;
      backdrop-filter: blur(10px);
    }

    .home-btn:hover {
      background: rgba(255, 255, 255, 0.25);
      border-color: rgba(255, 255, 255, 0.5);
      transform: scale(1.1);
    }

    .header h1 {
      font-size: 32px;
      margin-bottom: 12px;
      font-weight: 700;
      text-shadow: 0 2px 10px rgba(0, 0, 0, .2);
    }

    .header p {
      opacity: .95;
      font-size: 15px;
      line-height: 1.6;
    }

    .content {
      padding: 40px 30px;
    }

    /* Ê±áÁéáÊç¢ÁÆóÂ∑•ÂÖ∑ */
    .converter-section {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
      border: 1px solid #dee2e6;
    }

    .converter-section h2 {
      font-size: 22px;
      color: #2d3748;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .converter-form {
      display: flex;
      gap: 20px;
      align-items: flex-end;
      flex-wrap: wrap;
    }

    .input-group {
      flex: 1;
      min-width: 200px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .input-label {
      font-size: 13px;
      color: #718096;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .input-wrapper {
      display: flex;
      gap: 12px;
      align-items: stretch;
    }

    .amount-input {
      flex: 1;
      padding: 14px 18px;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 600;
      transition: all 0.3s;
      background: #fff;
    }

    .amount-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, .1);
    }

    .currency-select {
      min-width: 150px;
      padding: 14px 18px;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      font-size: 16px;
      background: #fff;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 500;
    }

    .currency-select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, .1);
    }

    /* Ëá™ÂÆö‰πâË¥ßÂ∏ÅÈÄâÊã©Âô® */
    .currency-select-wrapper {
      position: relative;
      min-width: 150px;
    }

    .currency-select-input {
      width: 100%;
      padding: 14px 40px 14px 18px;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      font-size: 16px;
      background: #fff;
      transition: all 0.3s;
      font-weight: 500;
      cursor: pointer;
    }

    .currency-select-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, .1);
      cursor: text;
    }

    .currency-select-arrow {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
      color: #667eea;
      font-size: 14px;
      transition: transform 0.3s;
    }

    .currency-select-wrapper.open .currency-select-arrow {
      transform: translateY(-50%) rotate(180deg);
    }

    .currency-dropdown {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      right: 0;
      background: #fff;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, .15);
      max-height: 300px;
      overflow-y: auto;
      z-index: 1000;
      display: none;
    }

    .currency-select-wrapper.open .currency-dropdown {
      display: block;
    }

    .currency-search-input {
      width: 100%;
      padding: 12px 16px;
      border: none;
      border-bottom: 2px solid #e9ecef;
      border-radius: 12px 12px 0 0;
      font-size: 14px;
      background: #f8f9fa;
    }

    .currency-search-input:focus {
      outline: none;
      background: #fff;
      border-bottom-color: #667eea;
    }

    .currency-options {
      max-height: 250px;
      overflow-y: auto;
    }

    .currency-option {
      padding: 12px 16px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 1px solid #f1f3f5;
    }

    .currency-option:last-child {
      border-bottom: none;
    }

    .currency-option:hover {
      background: #f8f9fa;
    }

    .currency-option.selected {
      background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);
      color: #667eea;
      font-weight: 600;
    }

    .currency-option-flag {
      font-size: 20px;
      flex-shrink: 0;
    }

    .currency-option-info {
      flex: 1;
      min-width: 0;
    }

    .currency-option-code {
      font-size: 14px;
      font-weight: 600;
      color: #2d3748;
    }

    .currency-option-name {
      font-size: 12px;
      color: #718096;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .currency-option.highlight {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
    }

    .currency-option.highlight .currency-option-code,
    .currency-option.highlight .currency-option-name {
      color: #fff;
    }

    .currency-no-results {
      padding: 20px;
      text-align: center;
      color: #a0aec0;
      font-size: 14px;
    }

    .arrow-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: #667eea;
      padding: 0 10px;
      flex-shrink: 0;
    }

    .result-display {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      padding: 20px 24px;
      border-radius: 12px;
      text-align: center;
      min-height: 80px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      margin-top: 20px;
      display: none;
    }

    .result-display.show {
      display: flex;
    }

    .result-amount {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .result-info {
      font-size: 14px;
      opacity: 0.9;
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* Ê±áÁéáÂàóË°® */
    .rates-section {
      margin-top: 30px;
    }

    .rates-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 15px;
    }

    .rates-title {
      font-size: 22px;
      color: #2d3748;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .search-box {
      flex: 1;
      min-width: 250px;
      max-width: 400px;
      padding: 12px 20px;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      font-size: 15px;
      transition: all 0.3s;
      background: #fff;
    }

    .search-box:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, .1);
    }

    .update-time {
      font-size: 13px;
      color: #718096;
      text-align: right;
    }

    .rates-section-wrapper {
      position: relative;
    }

    .rates-list {
      background: #fff;
      border: 1px solid #e9ecef;
      border-radius: 12px;
      overflow: visible;
      position: relative;
    }

    .rates-list-header {
      display: grid;
      grid-template-columns: 60px 1fr 120px;
      gap: 16px;
      padding: 12px 16px;
      background: #f8f9fa;
      border-bottom: 2px solid #e9ecef;
      font-size: 12px;
      font-weight: 600;
      color: #718096;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .rate-row {
      display: grid;
      grid-template-columns: 60px 1fr 120px;
      gap: 16px;
      padding: 12px 16px;
      border-bottom: 1px solid #f1f3f5;
      transition: all 0.2s;
      cursor: pointer;
      align-items: center;
    }

    .rate-row:last-child {
      border-bottom: none;
    }

    .rate-row:hover {
      background: #f8f9fa;
      border-left: 3px solid #667eea;
    }

    .rate-flag {
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .rate-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-width: 0;
    }

    .rate-code-name {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .rate-code {
      font-size: 14px;
      font-weight: 700;
      color: #2d3748;
    }

    .rate-name {
      font-size: 12px;
      color: #718096;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .rate-value {
      font-size: 15px;
      font-weight: 600;
      color: #667eea;
      font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
      text-align: right;
    }

    /* Â≠óÊØçÂàÜÁªÑ */
    .rate-group {
      position: relative;
    }

    .rate-group-header {
      position: sticky;
      top: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      padding: 10px 16px;
      font-size: 16px;
      font-weight: 700;
      z-index: 10;
      box-shadow: 0 2px 4px rgba(0, 0, 0, .1);
    }

    /* Â≠óÊØçÊåáÁ§∫Âô® */
    .alphabet-indicator {
      position: fixed;
      right: 30px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      gap: 4px;
      z-index: 100;
      background: rgba(255, 255, 255, 0.98);
      backdrop-filter: blur(10px);
      padding: 10px 6px;
      border-radius: 18px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, .2);
      border: 1px solid rgba(102, 126, 234, .3);
      max-height: 80vh;
      overflow-y: auto;
      scrollbar-width: none;
    }

    .alphabet-indicator::-webkit-scrollbar {
      display: none;
    }

    .alphabet-item {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
      color: #667eea;
      cursor: pointer;
      border-radius: 50%;
      transition: all 0.2s;
      position: relative;
    }

    .alphabet-item:hover {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      transform: scale(1.1);
    }

    .alphabet-item.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      box-shadow: 0 2px 8px rgba(102, 126, 234, .4);
    }

    .alphabet-item.disabled {
      color: #cbd5e0;
      cursor: not-allowed;
      opacity: 0.5;
    }

    .alphabet-item.disabled:hover {
      background: transparent;
      transform: none;
    }

    .no-results {
      text-align: center;
      padding: 60px 20px;
      color: #a0aec0;
      display: none;
    }

    .no-results.show {
      display: block;
    }

    .error-message {
      background: #fee;
      color: #c33;
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 20px;
      border: 1px solid #fcc;
      display: none;
    }

    .error-message.show {
      display: block;
    }

    @media (max-width: 768px) {
      .converter-form {
        flex-direction: column;
      }

      .arrow-icon {
        transform: rotate(90deg);
        padding: 10px 0;
      }

      .rates-list-header,
      .rate-row {
        grid-template-columns: 50px 1fr 100px;
        gap: 12px;
        padding: 10px 12px;
      }

      .rate-code {
        font-size: 13px;
      }

      .rate-name {
        font-size: 11px;
      }

      .rate-value {
        font-size: 14px;
      }

      .rates-header {
        flex-direction: column;
        align-items: stretch;
      }

      .search-box {
        max-width: 100%;
      }

      .alphabet-indicator {
        right: 10px;
        padding: 8px 6px;
        border-radius: 16px;
      }

      .alphabet-item {
        width: 24px;
        height: 24px;
        font-size: 11px;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <a href="./index.html" class="home-btn" title="ËøîÂõûÈ¶ñÈ°µ">üè†</a>
      <h1></h1>
      <p></p>
    </div>
    <div class="content">
      <!-- Ê±áÁéáÊç¢ÁÆóÂ∑•ÂÖ∑ -->
      <div class="converter-section">
        <h2>
          <span>üí±</span>
          <span>Ê±áÁéáÊç¢ÁÆó</span>
        </h2>
        <div class="converter-form">
          <div class="input-group">
            <label class="input-label">ÈáëÈ¢ù</label>
            <div class="input-wrapper">
              <input type="number" class="amount-input" id="amountInput" placeholder="0" step="any" value="1">
            </div>
          </div>
          <div class="input-group">
            <label class="input-label">‰ªé</label>
            <div class="currency-select-wrapper" id="fromCurrencyWrapper">
              <input type="text" class="currency-select-input" id="fromCurrencyInput" readonly placeholder="ÈÄâÊã©Ë¥ßÂ∏Å">
              <span class="currency-select-arrow">‚ñº</span>
              <div class="currency-dropdown">
                <input type="text" class="currency-search-input" id="fromCurrencySearch" placeholder="üîç ÊêúÁ¥¢Ë¥ßÂ∏Å...">
                <div class="currency-options" id="fromCurrencyOptions"></div>
              </div>
            </div>
            <select class="currency-select" id="fromCurrency" style="display: none;">
              <option value="CNY">‰∫∫Ê∞ëÂ∏Å (CNY)</option>
            </select>
          </div>
          <div class="arrow-icon">‚áÑ</div>
          <div class="input-group">
            <label class="input-label">Âà∞</label>
            <div class="currency-select-wrapper" id="toCurrencyWrapper">
              <input type="text" class="currency-select-input" id="toCurrencyInput" readonly placeholder="ÈÄâÊã©Ë¥ßÂ∏Å">
              <span class="currency-select-arrow">‚ñº</span>
              <div class="currency-dropdown">
                <input type="text" class="currency-search-input" id="toCurrencySearch" placeholder="üîç ÊêúÁ¥¢Ë¥ßÂ∏Å...">
                <div class="currency-options" id="toCurrencyOptions"></div>
              </div>
            </div>
            <select class="currency-select" id="toCurrency" style="display: none;">
              <option value="USD">ÁæéÂÖÉ (USD)</option>
            </select>
          </div>
        </div>
        <div class="result-display" id="resultDisplay">
          <div class="result-amount" id="resultAmount"></div>
          <div class="result-info" id="resultInfo"></div>
        </div>
      </div>

      <!-- ÈîôËØØÊèêÁ§∫ -->
      <div class="error-message" id="errorMessage"></div>

      <!-- Ê±áÁéáÂàóË°® -->
      <div class="rates-section">
        <div class="rates-header">
          <div class="rates-title">
            <span>üìä</span>
            <span>ÂÆûÊó∂Ê±áÁéáÂàóË°®</span>
          </div>
          <input type="text" class="search-box" id="searchInput" placeholder="üîç ÊêúÁ¥¢Ë¥ßÂ∏Å...">
          <div class="update-time" id="updateTime"></div>
        </div>
        <div class="rates-section-wrapper">
          <div class="rates-list" id="ratesList">
            <div class="rates-list-header">
              <div>Ë¥ßÂ∏Å</div>
              <div>ÂêçÁß∞</div>
              <div style="text-align: right;">Ê±áÁéá</div>
            </div>
            <div id="ratesGrid"></div>
            <div class="alphabet-indicator" id="alphabetIndicator"></div>
          </div>
        </div>
        <div class="no-results" id="noResults">
          <div style="font-size: 18px; margin-bottom: 8px;">Êú™ÊâæÂà∞Áõ∏ÂÖ≥Ë¥ßÂ∏Å</div>
          <div>ËØïËØïÂÖ∂‰ªñÂÖ≥ÈîÆËØçÂêß</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Ë¥ßÂ∏Å‰ª£Á†ÅÂà∞ÂõΩÂÆ∂ÂõæÊ†áÁöÑÊò†Â∞Ñ
    const currencyFlags = {
      'AED': 'üá¶üá™', 'AFN': 'üá¶üá´', 'ALL': 'üá¶üá±', 'AMD': 'üá¶üá≤', 'ANG': 'üá®üáº', 'AOA': 'üá¶üá¥', 'ARS': 'üá¶üá∑', 'AUD': 'üá¶üá∫',
      'AWG': 'üá¶üáº', 'AZN': 'üá¶üáø', 'BAM': 'üáßüá¶', 'BBD': 'üáßüáß', 'BDT': 'üáßüá©', 'BGN': 'üáßüá¨', 'BHD': 'üáßüá≠', 'BIF': 'üáßüáÆ',
      'BMD': 'üáßüá≤', 'BND': 'üáßüá≥', 'BOB': 'üáßüá¥', 'BRL': 'üáßüá∑', 'BSD': 'üáßüá∏', 'BTN': 'üáßüáπ', 'BWP': 'üáßüáº', 'BYN': 'üáßüáæ',
      'BZD': 'üáßüáø', 'CAD': 'üá®üá¶', 'CDF': 'üá®üá©', 'CHF': 'üá®üá≠', 'CLP': 'üá®üá±', 'CNY': 'üá®üá≥', 'COP': 'üá®üá¥', 'CRC': 'üá®üá∑',
      'CUP': 'üá®üá∫', 'CVE': 'üá®üáª', 'CZK': 'üá®üáø', 'DJF': 'üá©üáØ', 'DKK': 'üá©üá∞', 'DOP': 'üá©üá¥', 'DZD': 'üá©üáø', 'EGP': 'üá™üá¨',
      'ERN': 'üá™üá∑', 'ETB': 'üá™üáπ', 'EUR': 'üá™üá∫', 'FJD': 'üá´üáØ', 'FKP': 'üá´üá∞', 'GBP': 'üá¨üáß', 'GEL': 'üá¨üá™', 'GHS': 'üá¨üá≠',
      'GIP': 'üá¨üáÆ', 'GMD': 'üá¨üá≤', 'GNF': 'üá¨üá≥', 'GTQ': 'üá¨üáπ', 'GYD': 'üá¨üáæ', 'HKD': 'üá≠üá∞', 'HNL': 'üá≠üá≥', 'HRK': 'üá≠üá∑',
      'HTG': 'üá≠üáπ', 'HUF': 'üá≠üá∫', 'IDR': 'üáÆüá©', 'ILS': 'üáÆüá±', 'INR': 'üáÆüá≥', 'IQD': 'üáÆüá∂', 'IRR': 'üáÆüá∑', 'ISK': 'üáÆüá∏',
      'JMD': 'üáØüá≤', 'JOD': 'üáØüá¥', 'JPY': 'üáØüáµ', 'KES': 'üá∞üá™', 'KGS': 'üá∞üá¨', 'KHR': 'üá∞üá≠', 'KMF': 'üá∞üá≤', 'KPW': 'üá∞üáµ',
      'KRW': 'üá∞üá∑', 'KWD': 'üá∞üáº', 'KYD': 'üá∞üáæ', 'KZT': 'üá∞üáø', 'LAK': 'üá±üá¶', 'LBP': 'üá±üáß', 'LKR': 'üá±üá∞', 'LRD': 'üá±üá∑',
      'LSL': 'üá±üá∏', 'LYD': 'üá±üáæ', 'MAD': 'üá≤üá¶', 'MDL': 'üá≤üá©', 'MGA': 'üá≤üá¨', 'MKD': 'üá≤üá∞', 'MMK': 'üá≤üá≤', 'MNT': 'üá≤üá≥',
      'MOP': 'üá≤üá¥', 'MRU': 'üá≤üá∑', 'MUR': 'üá≤üá∫', 'MVR': 'üá≤üáª', 'MWK': 'üá≤üáº', 'MXN': 'üá≤üáΩ', 'MYR': 'üá≤üáæ', 'MZN': 'üá≤üáø',
      'NAD': 'üá≥üá¶', 'NGN': 'üá≥üá¨', 'NIO': 'üá≥üáÆ', 'NOK': 'üá≥üá¥', 'NPR': 'üá≥üáµ', 'NZD': 'üá≥üáø', 'OMR': 'üá¥üá≤', 'PAB': 'üáµüá¶',
      'PEN': 'üáµüá™', 'PGK': 'üáµüá¨', 'PHP': 'üáµüá≠', 'PKR': 'üáµüá∞', 'PLN': 'üáµüá±', 'PYG': 'üáµüáæ', 'QAR': 'üá∂üá¶', 'RON': 'üá∑üá¥',
      'RSD': 'üá∑üá∏', 'RUB': 'üá∑üá∫', 'RWF': 'üá∑üáº', 'SAR': 'üá∏üá¶', 'SBD': 'üá∏üáß', 'SCR': 'üá∏üá®', 'SDG': 'üá∏üá©', 'SEK': 'üá∏üá™',
      'SGD': 'üá∏üá¨', 'SHP': 'üá∏üá≠', 'SLE': 'üá∏üá±', 'SLL': 'üá∏üá±', 'SOS': 'üá∏üá¥', 'SRD': 'üá∏üá∑', 'STN': 'üá∏üáπ', 'SYP': 'üá∏üáæ',
      'SZL': 'üá∏üáø', 'THB': 'üáπüá≠', 'TJS': 'üáπüáØ', 'TMT': 'üáπüá≤', 'TND': 'üáπüá≥', 'TOP': 'üáπüá¥', 'TRY': 'üáπüá∑', 'TTD': 'üáπüáπ',
      'TWD': 'üáπüáº', 'TZS': 'üáπüáø', 'UAH': 'üá∫üá¶', 'UGX': 'üá∫üá¨', 'USD': 'üá∫üá∏', 'UYU': 'üá∫üáæ', 'UZS': 'üá∫üáø', 'VES': 'üáªüá™',
      'VND': 'üáªüá≥', 'VUV': 'üáªüá∫', 'WST': 'üáºüá∏', 'XAF': 'üá®üá≤', 'XCD': 'üá¶üá¨', 'XOF': 'üá∏üá≥', 'XPF': 'üáµüá´', 'YER': 'üáæüá™',
      'ZAR': 'üáøüá¶', 'ZMW': 'üáøüá≤', 'ZWL': 'üáøüáº'
    };

    // Ë¥ßÂ∏Å‰ª£Á†ÅÂà∞Ë¥ßÂ∏ÅÂêçÁß∞ÁöÑÊò†Â∞Ñ
    const currencyNames = {
      'AED': 'ÈòøËÅîÈÖãËø™ÊãâÂßÜ', 'AFN': 'ÈòøÂØåÊ±óÂ∞º', 'ALL': 'ÈòøÂ∞îÂ∑¥Â∞º‰∫öÂàóÂÖã', 'AMD': '‰∫öÁæéÂ∞º‰∫öÂæ∑ÊãâÂßÜ', 'ANG': 'Ëç∑Â±ûÂÆâÁöÑÂàóÊñØÁõæ', 'AOA': 'ÂÆâÂì•ÊãâÂÆΩÊâé', 'ARS': 'ÈòøÊ†πÂª∑ÊØîÁ¥¢', 'AUD': 'Êæ≥ÂÖÉ',
      'AWG': 'ÈòøÈ≤ÅÂ∑¥ÂºóÁΩóÊûó', 'AZN': 'ÈòøÂ°ûÊãúÁñÜÈ©¨Á∫≥Áâπ', 'BAM': 'Ê≥¢ÈªëÂèØÂÖëÊç¢È©¨ÂÖã', 'BBD': 'Â∑¥Â∑¥Â§öÊñØÂÖÉ', 'BDT': 'Â≠üÂä†ÊãâÂ°îÂç°', 'BGN': '‰øùÂä†Âà©‰∫öÂàóÂºó', 'BHD': 'Â∑¥ÊûóÁ¨¨Á∫≥Â∞î', 'BIF': 'Â∏ÉÈöÜËø™Ê≥ïÈÉé',
      'BMD': 'ÁôæÊÖïÂ§ßÂÖÉ', 'BND': 'ÊñáËé±ÂÖÉ', 'BOB': 'ÁéªÂà©Áª¥‰∫öËØ∫', 'BRL': 'Â∑¥Ë•øÈõ∑‰∫öÂ∞î', 'BSD': 'Â∑¥ÂìàÈ©¨ÂÖÉ', 'BTN': '‰∏ç‰∏πÂä™Â∞îÁâπÈ≤ÅÂßÜ', 'BWP': 'ÂçöËå®Áì¶Á∫≥ÊôÆÊãâ', 'BYN': 'ÁôΩ‰øÑÁΩóÊñØÂç¢Â∏É',
      'BZD': '‰ºØÂà©ÂÖπÂÖÉ', 'CAD': 'Âä†ÂÖÉ', 'CDF': 'ÂàöÊûúÊ≥ïÈÉé', 'CHF': 'ÁëûÂ£´Ê≥ïÈÉé', 'CLP': 'Êô∫Âà©ÊØîÁ¥¢', 'CNY': '‰∫∫Ê∞ëÂ∏Å', 'COP': 'Âì•‰º¶ÊØî‰∫öÊØîÁ¥¢', 'CRC': 'Âì•ÊñØËææÈªéÂä†ÁßëÊúó',
      'CUP': 'Âè§Â∑¥ÊØîÁ¥¢', 'CVE': '‰ΩõÂæóËßíÂüÉÊñØÂ∫ìÂ§ö', 'CZK': 'Êç∑ÂÖãÂÖãÊúó', 'DJF': 'ÂêâÂ∏ÉÊèêÊ≥ïÈÉé', 'DKK': '‰∏πÈ∫¶ÂÖãÊúó', 'DOP': 'Â§öÁ±≥Â∞ºÂä†ÊØîÁ¥¢', 'DZD': 'ÈòøÂ∞îÂèäÂà©‰∫öÁ¨¨Á∫≥Â∞î', 'EGP': 'ÂüÉÂèäÈïë',
      'ERN': 'ÂéÑÁ´ãÁâπÈáå‰∫öÁ∫≥ÂÖãÊ≥ï', 'ETB': 'ÂüÉÂ°û‰øÑÊØî‰∫öÊØîÂ∞î', 'EUR': 'Ê¨ßÂÖÉ', 'FJD': 'ÊñêÊµéÂÖÉ', 'FKP': 'Á¶èÂÖãÂÖ∞Áæ§Â≤õÈïë', 'GBP': 'Ëã±Èïë', 'GEL': 'Ê†ºÈ≤ÅÂêâ‰∫öÊãâÈáå', 'GHS': 'Âä†Á∫≥Â°ûÂú∞',
      'GIP': 'Áõ¥Â∏ÉÁΩóÈôÄÈïë', 'GMD': 'ÂÜàÊØî‰∫öËææÊãâË•ø', 'GNF': 'Âá†ÂÜÖ‰∫öÊ≥ïÈÉé', 'GTQ': 'Âç±Âú∞È©¨ÊãâÊ†ºÊü•Â∞î', 'GYD': 'Âú≠‰∫öÈÇ£ÂÖÉ', 'HKD': 'Ê∏ØÂ∏Å', 'HNL': 'Ê¥™ÈÉΩÊãâÊñØ‰º¶ÁöÆÊãâ', 'HRK': 'ÂÖãÁΩóÂú∞‰∫öÂ∫ìÁ∫≥',
      'HTG': 'Êµ∑Âú∞Âè§Âæ∑', 'HUF': 'ÂåàÁâôÂà©Á¶èÊûó', 'IDR': 'Âç∞Â∞ºÁõæ', 'ILS': '‰ª•Ëâ≤ÂàóÊñ∞Ë∞¢ÂÖãÂ∞î', 'INR': 'Âç∞Â∫¶Âç¢ÊØî', 'IQD': '‰ºäÊãâÂÖãÁ¨¨Á∫≥Â∞î', 'IRR': '‰ºäÊúóÈáå‰∫öÂ∞î', 'ISK': 'ÂÜ∞Â≤õÂÖãÊúó',
      'JMD': 'Áâô‰π∞Âä†ÂÖÉ', 'JOD': 'Á∫¶Êó¶Á¨¨Á∫≥Â∞î', 'JPY': 'Êó•ÂÖÉ', 'KES': 'ËÇØÂ∞º‰∫öÂÖà‰ª§', 'KGS': 'ÂêâÂ∞îÂêâÊñØÊñØÂù¶Á¥¢ÂßÜ', 'KHR': 'Êü¨ÂüîÂØ®ÁëûÂ∞î', 'KMF': 'ÁßëÊë©ÁΩóÊ≥ïÈÉé', 'KPW': 'ÊúùÈ≤úÂÖÉ',
      'KRW': 'Èü©ÂÖÉ', 'KWD': 'ÁßëÂ®ÅÁâπÁ¨¨Á∫≥Â∞î', 'KYD': 'ÂºÄÊõºÁæ§Â≤õÂÖÉ', 'KZT': 'ÂìàËê®ÂÖãÊñØÂù¶ÂùöÊàà', 'LAK': 'ËÄÅÊåùÂü∫ÊôÆ', 'LBP': 'ÈªéÂ∑¥Â´©Èïë', 'LKR': 'ÊñØÈáåÂÖ∞Âç°Âç¢ÊØî', 'LRD': 'Âà©ÊØîÈáå‰∫öÂÖÉ',
      'LSL': 'Ëé±Á¥¢ÊâòÊ¥õËíÇ', 'LYD': 'Âà©ÊØî‰∫öÁ¨¨Á∫≥Â∞î', 'MAD': 'Êë©Ê¥õÂì•Ëø™ÊãâÂßÜ', 'MDL': 'Êë©Â∞îÂ§öÁì¶Âàó‰ºä', 'MGA': 'È©¨ËææÂä†ÊñØÂä†ÈòøÈáå‰∫öÈáå', 'MKD': 'È©¨ÂÖ∂È°øÁ¨¨Á∫≥Â∞î', 'MMK': 'ÁºÖÁî∏ÂÖÉ', 'MNT': 'ËíôÂè§ÂõæÊ†ºÈáåÂÖã',
      'MOP': 'Êæ≥Èó®ÂÖÉ', 'MRU': 'ÊØõÈáåÂ°îÂ∞º‰∫ö‰πåÂêâ‰∫ö', 'MUR': 'ÊØõÈáåÊ±ÇÊñØÂç¢ÊØî', 'MVR': 'È©¨Â∞î‰ª£Â§´ÊãâËè≤‰∫ö', 'MWK': 'È©¨ÊãâÁª¥ÂÖãÁì¶Êü•', 'MXN': 'Â¢®Ë•øÂì•ÊØîÁ¥¢', 'MYR': 'È©¨Êù•Ë•ø‰∫öÊûóÂêâÁâπ', 'MZN': 'Ëé´Ê°ëÊØîÂÖãÊ¢ÖËíÇÂç°Â∞î',
      'NAD': 'Á∫≥Á±≥ÊØî‰∫öÂÖÉ', 'NGN': 'Â∞ºÊó•Âà©‰∫öÂ•àÊãâ', 'NIO': 'Â∞ºÂä†ÊãâÁìúÁßëÂ§öÂ∑¥', 'NOK': 'Êå™Â®ÅÂÖãÊúó', 'NPR': 'Â∞ºÊ≥äÂ∞îÂç¢ÊØî', 'NZD': 'Êñ∞Ë•øÂÖ∞ÂÖÉ', 'OMR': 'ÈòøÊõºÈáå‰∫öÂ∞î', 'PAB': 'Â∑¥ÊãøÈ©¨Â∑¥Ê≥¢‰∫ö',
      'PEN': 'ÁßòÈ≤ÅÁ¥¢Â∞î', 'PGK': 'Â∑¥Â∏É‰∫öÊñ∞Âá†ÂÜÖ‰∫öÂü∫ÈÇ£', 'PHP': 'Ëè≤ÂæãÂÆæÊØîÁ¥¢', 'PKR': 'Â∑¥Âü∫ÊñØÂù¶Âç¢ÊØî', 'PLN': 'Ê≥¢ÂÖ∞ÂÖπÁΩóÊèê', 'PYG': 'Â∑¥ÊãâÂú≠ÁìúÊãâÂ∞º', 'QAR': 'Âç°Â°îÂ∞îÈáå‰∫öÂ∞î', 'RON': 'ÁΩóÈ©¨Â∞º‰∫öÂàó‰ºä',
      'RSD': 'Â°ûÂ∞îÁª¥‰∫öÁ¨¨Á∫≥Â∞î', 'RUB': '‰øÑÁΩóÊñØÂç¢Â∏É', 'RWF': 'Âç¢Êó∫ËææÊ≥ïÈÉé', 'SAR': 'Ê≤ôÁâπÈáå‰∫öÂ∞î', 'SBD': 'ÊâÄÁΩóÈó®Áæ§Â≤õÂÖÉ', 'SCR': 'Â°ûËàåÂ∞îÂç¢ÊØî', 'SDG': 'Ëãè‰∏πÈïë', 'SEK': 'ÁëûÂÖ∏ÂÖãÊúó',
      'SGD': 'Êñ∞Âä†Âù°ÂÖÉ', 'SHP': 'Âú£Ëµ´ÂãíÊãøÈïë', 'SLE': 'Â°ûÊãâÂà©ÊòÇÂà©ÊòÇ', 'SLL': 'Â°ûÊãâÂà©ÊòÇÂà©ÊòÇ', 'SOS': 'Á¥¢È©¨ÈáåÂÖà‰ª§', 'SRD': 'ËãèÈáåÂçóÂÖÉ', 'STN': 'Âú£Â§öÁæéÂíåÊôÆÊûóË•øÊØîÂ§öÂ∏ÉÊãâ', 'SYP': 'ÂèôÂà©‰∫öÈïë',
      'SZL': 'ÊñØÂ®ÅÂ£´ÂÖ∞ÈáåÂÖ∞ÂêâÂ∞º', 'THB': 'Ê≥∞Èì¢', 'TJS': 'Â°îÂêâÂÖãÊñØÂù¶Á¥¢Ëé´Â∞º', 'TMT': 'ÂúüÂ∫ìÊõºÊñØÂù¶È©¨Á∫≥Áâπ', 'TND': 'Á™ÅÂ∞ºÊñØÁ¨¨Á∫≥Â∞î', 'TOP': 'Ê±§Âä†ÊΩòÂä†', 'TRY': 'ÂúüËÄ≥ÂÖ∂ÈáåÊãâ', 'TTD': 'ÁâπÁ´ãÂ∞ºËææÂíåÂ§öÂ∑¥Âì•ÂÖÉ',
      'TWD': 'Êñ∞Âè∞Â∏Å', 'TZS': 'Âù¶Ê°ëÂ∞º‰∫öÂÖà‰ª§', 'UAH': '‰πåÂÖãÂÖ∞Ê†ºÈáåÂ§´Á∫≥', 'UGX': '‰πåÂπ≤ËææÂÖà‰ª§', 'USD': 'ÁæéÂÖÉ', 'UYU': '‰πåÊãâÂú≠ÊØîÁ¥¢', 'UZS': '‰πåÂÖπÂà´ÂÖãÊñØÂù¶Á¥¢ÂßÜ', 'VES': 'ÂßîÂÜÖÁëûÊãâÁéªÂà©Áì¶Â∞î',
      'VND': 'Ë∂äÂçóÁõæ', 'VUV': 'Áì¶Âä™ÈòøÂõæÁì¶Âõæ', 'WST': 'Ëê®Êë©‰∫öÂ°îÊãâ', 'XAF': '‰∏≠ÈùûÊ≥ïÈÉé', 'XCD': '‰∏úÂä†ÂãíÊØîÂÖÉ', 'XOF': 'Ë•øÈùûÊ≥ïÈÉé', 'XPF': 'Â§™Âπ≥Ê¥ãÊ≥ïÈÉé', 'YER': '‰πüÈó®Èáå‰∫öÂ∞î',
      'ZAR': 'ÂçóÈùûÂÖ∞Áâπ', 'ZMW': 'ËµûÊØî‰∫öÂÖãÁì¶Êü•', 'ZWL': 'Ê¥•Â∑¥Â∏ÉÈü¶ÂÖÉ'
    };

    let exchangeRates = {};
    let availableCurrencies = [];
    let baseCurrency = 'CNY';
    let lastUpdateTime = null;
    let fromCurrencySelect = null;
    let toCurrencySelect = null;

    // Ëé∑ÂèñË¥ßÂ∏Å‰ø°ÊÅØ
    function getCurrencyInfo(code) {
      return {
        code: code,
        name: currencyNames[code] || code,
        flag: currencyFlags[code] || 'üí±'
      };
    }

    // ÂàùÂßãÂåñËá™ÂÆö‰πâË¥ßÂ∏ÅÈÄâÊã©Âô®
    function initCustomCurrencySelect(selectId, inputId, searchId, optionsId, wrapperId) {
      const select = document.getElementById(selectId);
      const input = document.getElementById(inputId);
      const search = document.getElementById(searchId);
      const options = document.getElementById(optionsId);
      const wrapper = document.getElementById(wrapperId);

      let currentValue = select.value;
      let highlightedIndex = -1;

      // Ê∏≤ÊüìÈÄâÈ°π
      function renderOptions(query = '') {
        options.innerHTML = '';
        const queryLower = query.toLowerCase().trim();

        const filtered = availableCurrencies
          .map(code => {
            const info = getCurrencyInfo(code);
            return { code, ...info };
          })
          .filter(currency => {
            if (!queryLower) return true;
            return currency.code.toLowerCase().includes(queryLower) ||
              currency.name.toLowerCase().includes(queryLower);
          })
          .sort((a, b) => a.code.localeCompare(b.code));

        if (filtered.length === 0) {
          options.innerHTML = '<div class="currency-no-results">Êú™ÊâæÂà∞ÂåπÈÖçÁöÑË¥ßÂ∏Å</div>';
          return;
        }

        filtered.forEach((currency, index) => {
          const option = document.createElement('div');
          option.className = 'currency-option' + (currency.code === currentValue ? ' selected' : '');
          option.dataset.code = currency.code;
          option.innerHTML = `
            <span class="currency-option-flag">${currency.flag}</span>
            <div class="currency-option-info">
              <div class="currency-option-code">${currency.code}</div>
              <div class="currency-option-name">${currency.name}</div>
            </div>
          `;
          option.onclick = () => selectCurrency(currency.code);
          options.appendChild(option);
        });
      }

      // ÈÄâÊã©Ë¥ßÂ∏Å
      function selectCurrency(code) {
        currentValue = code;
        select.value = code;
        const info = getCurrencyInfo(code);
        input.value = `${info.flag} ${info.name} (${code})`;
        wrapper.classList.remove('open');
        search.value = '';
        highlightedIndex = -1;

        // Ëß¶Âèëchange‰∫ã‰ª∂
        select.dispatchEvent(new Event('change', { bubbles: true }));
      }

      // ÊâìÂºÄ/ÂÖ≥Èó≠‰∏ãÊãâÊ°Ü
      function toggleDropdown() {
        const isOpen = wrapper.classList.contains('open');
        if (isOpen) {
          wrapper.classList.remove('open');
          input.readOnly = true;
        } else {
          wrapper.classList.add('open');
          input.readOnly = false;
          search.focus();
          renderOptions();
        }
      }

      // ÈîÆÁõòÂØºËà™
      function handleKeyNavigation(e) {
        if (!wrapper.classList.contains('open')) return;

        const optionElements = options.querySelectorAll('.currency-option');
        if (optionElements.length === 0) return;

        if (e.key === 'ArrowDown') {
          e.preventDefault();
          highlightedIndex = (highlightedIndex + 1) % optionElements.length;
          updateHighlight(optionElements);
        } else if (e.key === 'ArrowUp') {
          e.preventDefault();
          highlightedIndex = highlightedIndex <= 0 ? optionElements.length - 1 : highlightedIndex - 1;
          updateHighlight(optionElements);
        } else if (e.key === 'Enter') {
          e.preventDefault();
          if (highlightedIndex >= 0 && optionElements[highlightedIndex]) {
            optionElements[highlightedIndex].click();
          }
        } else if (e.key === 'Escape') {
          wrapper.classList.remove('open');
          input.readOnly = true;
        }
      }

      function updateHighlight(optionElements) {
        optionElements.forEach((el, index) => {
          el.classList.toggle('highlight', index === highlightedIndex);
        });
        if (highlightedIndex >= 0) {
          optionElements[highlightedIndex].scrollIntoView({ block: 'nearest' });
        }
      }

      // ‰∫ã‰ª∂ÁªëÂÆö
      input.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleDropdown();
      });

      search.addEventListener('input', (e) => {
        renderOptions(e.target.value);
        highlightedIndex = -1;
      });

      search.addEventListener('keydown', handleKeyNavigation);
      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          toggleDropdown();
        }
      });

      // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠
      document.addEventListener('click', (e) => {
        if (!wrapper.contains(e.target)) {
          wrapper.classList.remove('open');
          input.readOnly = true;
        }
      });

      // Êõ¥Êñ∞ÊòæÁ§∫ÂÄº
      function updateDisplay() {
        if (currentValue) {
          const info = getCurrencyInfo(currentValue);
          input.value = `${info.flag} ${info.name} (${currentValue})`;
        }
      }

      // ÁõëÂê¨selectÂèòÂåñ
      select.addEventListener('change', () => {
        currentValue = select.value;
        updateDisplay();
        renderOptions();
      });

      // ÂàùÂßãÂåñÊòæÁ§∫
      updateDisplay();

      return { selectCurrency, updateDisplay };
    }

    // ÂàùÂßãÂåñË¥ßÂ∏ÅÈÄâÊã©Âô®Ôºà‰øùÁïôÂéüÊúâÈÄªËæëÁî®‰∫éÂêåÊ≠•Ôºâ
    function initCurrencySelects(isInitial = false) {
      const fromSelect = document.getElementById('fromCurrency');
      const toSelect = document.getElementById('toCurrency');

      // ‰øùÂ≠òÂΩìÂâçÈÄâÊã©ÁöÑÂÄº
      const currentFrom = fromSelect.value;
      const currentTo = toSelect.value;

      // Ê∏ÖÁ©∫Áé∞ÊúâÈÄâÈ°π
      fromSelect.innerHTML = '';
      toSelect.innerHTML = '';

      // ÊåâË¥ßÂ∏Å‰ª£Á†ÅÊéíÂ∫è
      const sortedCurrencies = [...availableCurrencies].sort((a, b) => a.localeCompare(b));

      sortedCurrencies.forEach(code => {
        const info = getCurrencyInfo(code);

        const option1 = document.createElement('option');
        option1.value = code;
        option1.textContent = `${info.flag} ${info.name} (${code})`;
        fromSelect.appendChild(option1);

        const option2 = document.createElement('option');
        option2.value = code;
        option2.textContent = `${info.flag} ${info.name} (${code})`;
        toSelect.appendChild(option2);
      });

      // Âè™Âú®ÂàùÂßãÂåñÊó∂ËÆæÁΩÆÈªòËÆ§ÂÄºÔºåÂê¶Âàô‰øùÊåÅÂΩìÂâçÈÄâÊã©
      if (isInitial) {
        const fromValue = availableCurrencies.includes('CNY') ? 'CNY' : (availableCurrencies.length > 0 ? availableCurrencies[0] : '');
        if (fromValue) {
          fromSelect.value = fromValue;

          // ËÆæÁΩÆÁõÆÊ†áË¥ßÂ∏ÅÔºåÁ°Æ‰øù‰∏çÊòØÂü∫Á°ÄË¥ßÂ∏Å
          const toValue = availableCurrencies.includes('USD') && 'USD' !== fromValue
            ? 'USD'
            : availableCurrencies.find(c => c !== fromValue) || availableCurrencies[0];
          if (toValue && toValue !== fromValue) {
            toSelect.value = toValue;
          }
        }
      } else {
        // ÊÅ¢Â§ç‰πãÂâçÁöÑÈÄâÊã©ÔºåÂ¶ÇÊûú‰ªçÁÑ∂ÂèØÁî®
        if (currentFrom && availableCurrencies.includes(currentFrom)) {
          fromSelect.value = currentFrom;
        } else if (availableCurrencies.length > 0) {
          fromSelect.value = availableCurrencies[0];
        }

        if (currentTo && availableCurrencies.includes(currentTo) && currentTo !== fromSelect.value) {
          toSelect.value = currentTo;
        } else {
          const fromValue = fromSelect.value;
          const toValue = availableCurrencies.find(c => c !== fromValue);
          if (toValue) {
            toSelect.value = toValue;
          }
        }
      }
    }

    // Ëé∑ÂèñÊ±áÁéáÊï∞ÊçÆ
    async function fetchExchangeRates(base = 'CNY') {
      try {
        // ‰ΩøÁî® exchangerate-api.com ÁöÑÂÖçË¥π API
        const response = await fetch(`https://api.exchangerate-api.com/v4/latest/${base}`);
        if (!response.ok) {
          throw new Error('Ëé∑ÂèñÊ±áÁéáÊï∞ÊçÆÂ§±Ë¥•');
        }
        const data = await response.json();
        exchangeRates = data.rates;
        baseCurrency = base;

        // ‰ªéAPIËøîÂõûÁöÑrates‰∏≠Ëé∑ÂèñÊâÄÊúâÂèØÁî®ÁöÑË¥ßÂ∏Å‰ª£Á†ÅÔºàÂåÖÊã¨Âü∫Á°ÄË¥ßÂ∏ÅÔºâ
        availableCurrencies = [base, ...Object.keys(data.rates)].filter((v, i, a) => a.indexOf(v) === i);

        lastUpdateTime = new Date();

        // Êõ¥Êñ∞Ë¥ßÂ∏ÅÈÄâÊã©Âô®ÔºàÈùûÂàùÂßãÂåñÔºå‰øùÊåÅÂΩìÂâçÈÄâÊã©Ôºâ
        initCurrencySelects(false);

        // Êõ¥Êñ∞Ëá™ÂÆö‰πâÈÄâÊã©Âô®ÔºàÂ¶ÇÊûúÂ∑≤ÂàùÂßãÂåñÔºâ
        if (fromCurrencySelect && typeof fromCurrencySelect.updateDisplay === 'function') {
          fromCurrencySelect.updateDisplay();
        }
        if (toCurrencySelect && typeof toCurrencySelect.updateDisplay === 'function') {
          toCurrencySelect.updateDisplay();
        }

        return true;
      } catch (error) {
        console.error('Ëé∑ÂèñÊ±áÁéáÂ§±Ë¥•:', error);
        showError('Êó†Ê≥ïËé∑ÂèñÂÆûÊó∂Ê±áÁéáÊï∞ÊçÆÔºåËØ∑Á®çÂêéÈáçËØï');
        return false;
      }
    }

    // ÊòæÁ§∫ÈîôËØØ‰ø°ÊÅØ
    function showError(message) {
      const errorDiv = document.getElementById('errorMessage');
      errorDiv.textContent = message;
      errorDiv.classList.add('show');
      setTimeout(() => {
        errorDiv.classList.remove('show');
      }, 5000);
    }

    // ÊâßË°åÊ±áÁéáËΩ¨Êç¢
    async function performConversion() {
      const amount = parseFloat(document.getElementById('amountInput').value);
      const from = document.getElementById('fromCurrency').value;
      const to = document.getElementById('toCurrency').value;

      if (isNaN(amount) || amount < 0) {
        document.getElementById('resultDisplay').classList.remove('show');
        return;
      }

      const resultDisplay = document.getElementById('resultDisplay');
      const resultAmount = document.getElementById('resultAmount');
      const resultInfo = document.getElementById('resultInfo');

      // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
      resultAmount.innerHTML = '<span class="loading"></span>';
      resultInfo.textContent = 'Ê≠£Âú®ËÆ°ÁÆó...';
      resultDisplay.classList.add('show');

      try {
        // Â¶ÇÊûúÂü∫Á°ÄË¥ßÂ∏ÅÊîπÂèòÔºåÈúÄË¶ÅÈáçÊñ∞Ëé∑ÂèñÊ±áÁéá
        // Ê≥®ÊÑèÔºöËøôÈáå‰∏çÂ∫îËØ•ÂÜçÊ¨°Ë∞ÉÁî®ÔºåÂõ†‰∏∫ÂàáÊç¢fromCurrencyÊó∂Â∑≤ÁªèË∞ÉÁî®Ëøá‰∫Ü
        if (baseCurrency !== from) {
          await fetchExchangeRates(from);
        }

        // ËÆ°ÁÆóËΩ¨Êç¢ÁªìÊûú
        let rate = exchangeRates[to];
        if (!rate) {
          // Â¶ÇÊûúÁõÆÊ†áË¥ßÂ∏Å‰∏çÂú®Ê±áÁéáÂàóË°®‰∏≠ÔºåÂèØËÉΩÊòØÂü∫Á°ÄË¥ßÂ∏ÅÊú¨Ë∫´
          if (to === from) {
            rate = 1;
          } else {
            throw new Error('Êú™ÊâæÂà∞ÁõÆÊ†áË¥ßÂ∏ÅÊ±áÁéá');
          }
        }

        const result = (amount * rate).toFixed(2);
        resultAmount.textContent = `${result} ${to}`;
        resultInfo.textContent = `1 ${from} = ${rate.toFixed(4)} ${to}`;
      } catch (error) {
        showError('ËΩ¨Êç¢Â§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï');
        resultDisplay.classList.remove('show');
      }
    }

    // ÊåâÈ¶ñÂ≠óÊØçÂàÜÁªÑË¥ßÂ∏Å
    function groupCurrenciesByLetter(currencies) {
      const groups = {};
      currencies.forEach(currency => {
        const firstLetter = currency.code.charAt(0).toUpperCase();
        if (!groups[firstLetter]) {
          groups[firstLetter] = [];
        }
        groups[firstLetter].push(currency);
      });

      // ÂØπÊØè‰∏™ÂàÜÁªÑÂÜÖÁöÑË¥ßÂ∏ÅËøõË°åÊéíÂ∫è
      Object.keys(groups).forEach(letter => {
        groups[letter].sort((a, b) => a.code.localeCompare(b.code));
      });

      return groups;
    }

    // Ê∏≤ÊüìÂ≠óÊØçÊåáÁ§∫Âô®
    function renderAlphabetIndicator(availableLetters) {
      const indicator = document.getElementById('alphabetIndicator');
      indicator.innerHTML = '';

      // ÁîüÊàêA-ZÂ≠óÊØç
      const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');

      alphabet.forEach(letter => {
        const item = document.createElement('div');
        item.className = 'alphabet-item';
        item.textContent = letter;
        item.dataset.letter = letter;

        if (!availableLetters.includes(letter)) {
          item.classList.add('disabled');
        } else {
          item.onclick = () => scrollToLetter(letter);
        }

        indicator.appendChild(item);
      });
    }

    // ÊªöÂä®Âà∞ÊåáÂÆöÂ≠óÊØçÂàÜÁªÑ
    function scrollToLetter(letter) {
      const groupElement = document.getElementById(`group-${letter}`);
      if (groupElement) {
        const headerOffset = 80;
        const elementPosition = groupElement.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

        window.scrollTo({
          top: offsetPosition,
          behavior: 'smooth'
        });

        // È´ò‰∫ÆÂΩìÂâçÂ≠óÊØç
        document.querySelectorAll('.alphabet-item').forEach(item => {
          item.classList.remove('active');
        });
        document.querySelector(`.alphabet-item[data-letter="${letter}"]`).classList.add('active');

        setTimeout(() => {
          document.querySelector(`.alphabet-item[data-letter="${letter}"]`).classList.remove('active');
        }, 1000);
      }
    }

    // ÁõëÂê¨ÊªöÂä®ÔºåÊõ¥Êñ∞ÂΩìÂâçÂ≠óÊØçÊåáÁ§∫Âô®
    function handleScroll() {
      const groups = document.querySelectorAll('.rate-group');
      const scrollPosition = window.pageYOffset + 100;

      let currentLetter = '';
      groups.forEach(group => {
        const groupTop = group.offsetTop;
        if (scrollPosition >= groupTop) {
          currentLetter = group.dataset.letter;
        }
      });

      if (currentLetter) {
        document.querySelectorAll('.alphabet-item').forEach(item => {
          item.classList.remove('active');
          if (item.dataset.letter === currentLetter) {
            item.classList.add('active');
          }
        });
      }
    }

    // Ê∏≤ÊüìÊ±áÁéáÂàóË°®
    function renderRatesList(searchQuery = '') {
      const grid = document.getElementById('ratesGrid');
      const noResults = document.getElementById('noResults');
      grid.innerHTML = '';

      const query = searchQuery.toLowerCase().trim();

      // ËøáÊª§Ë¥ßÂ∏ÅÂàóË°®ÔºàÊéíÈô§Âü∫Á°ÄË¥ßÂ∏ÅÊú¨Ë∫´Ôºâ
      let filteredCurrencies = availableCurrencies
        .filter(code => code !== baseCurrency)
        .map(code => {
          const info = getCurrencyInfo(code);
          return {
            code: code,
            name: info.name,
            flag: info.flag
          };
        });

      // Â∫îÁî®ÊêúÁ¥¢ËøáÊª§
      if (query) {
        filteredCurrencies = filteredCurrencies.filter(currency => {
          return currency.code.toLowerCase().includes(query) ||
            currency.name.toLowerCase().includes(query);
        });
      }

      if (filteredCurrencies.length === 0) {
        noResults.classList.add('show');
        grid.style.display = 'none';
        document.getElementById('alphabetIndicator').style.display = 'none';
        return;
      }

      noResults.classList.remove('show');
      grid.style.display = 'block';
      document.getElementById('alphabetIndicator').style.display = 'flex';

      // ÊåâÈ¶ñÂ≠óÊØçÂàÜÁªÑ
      const grouped = groupCurrenciesByLetter(filteredCurrencies);
      const availableLetters = Object.keys(grouped).sort();

      // Ê∏≤ÊüìÂ≠óÊØçÊåáÁ§∫Âô®
      renderAlphabetIndicator(availableLetters);

      // ÊåâÂ≠óÊØçÈ°∫Â∫èÊ∏≤ÊüìÂàÜÁªÑ
      availableLetters.forEach(letter => {
        const group = document.createElement('div');
        group.className = 'rate-group';
        group.id = `group-${letter}`;
        group.dataset.letter = letter;

        // ÂàÜÁªÑÊ†áÈ¢ò
        const header = document.createElement('div');
        header.className = 'rate-group-header';
        header.textContent = letter;
        group.appendChild(header);

        // ÂàÜÁªÑÂÜÖÂÆπ
        grouped[letter].forEach(currency => {
          const rate = exchangeRates[currency.code];
          if (!rate) return;

          const row = document.createElement('div');
          row.className = 'rate-row';
          row.onclick = () => {
            document.getElementById('toCurrency').value = currency.code;
            performConversion();
          };

          row.innerHTML = `
            <div class="rate-flag">${currency.flag}</div>
            <div class="rate-info">
              <div class="rate-code-name">
                <span class="rate-code">${currency.code}</span>
                <span class="rate-name">${currency.name}</span>
              </div>
            </div>
            <div class="rate-value">${rate.toFixed(4)}</div>
          `;

          group.appendChild(row);
        });

        grid.appendChild(group);
      });
    }

    // Êõ¥Êñ∞Êõ¥Êñ∞Êó∂Èó¥ÊòæÁ§∫
    function updateTimeDisplay() {
      const timeDiv = document.getElementById('updateTime');
      if (lastUpdateTime) {
        const timeStr = lastUpdateTime.toLocaleString('zh-CN');
        timeDiv.textContent = `Êõ¥Êñ∞Êó∂Èó¥: ${timeStr}`;
      }
    }

    // ÂàùÂßãÂåñ
    async function init() {
      // È¶ñÊ¨°Âä†ËΩΩÊ±áÁéáÊï∞ÊçÆÔºàÂàùÂßãÂåñË¥ßÂ∏ÅÈÄâÊã©Âô®Ôºâ
      const success = await fetchExchangeRates('CNY');
      if (success) {
        // ÂàùÂßãÂåñÊó∂ËÆæÁΩÆÈªòËÆ§ÂÄº
        initCurrencySelects(true);

        // ÂàùÂßãÂåñËá™ÂÆö‰πâÈÄâÊã©Âô®
        fromCurrencySelect = initCustomCurrencySelect(
          'fromCurrency', 'fromCurrencyInput', 'fromCurrencySearch',
          'fromCurrencyOptions', 'fromCurrencyWrapper'
        );
        toCurrencySelect = initCustomCurrencySelect(
          'toCurrency', 'toCurrencyInput', 'toCurrencySearch',
          'toCurrencyOptions', 'toCurrencyWrapper'
        );

        // Êõ¥Êñ∞Ëá™ÂÆö‰πâÈÄâÊã©Âô®ÊòæÁ§∫
        fromCurrencySelect.updateDisplay();
        toCurrencySelect.updateDisplay();

        renderRatesList();
        updateTimeDisplay();
        performConversion();
      }

      // ÁªëÂÆö‰∫ã‰ª∂
      document.getElementById('amountInput').addEventListener('input', performConversion);
      document.getElementById('fromCurrency').addEventListener('change', async () => {
        const from = document.getElementById('fromCurrency').value;
        const to = document.getElementById('toCurrency').value;

        // Ëé∑ÂèñÊñ∞ÁöÑÊ±áÁéáÊï∞ÊçÆÔºà‰ª•from‰∏∫Âü∫Á°ÄË¥ßÂ∏ÅÔºâ
        await fetchExchangeRates(from);

        // Ê£ÄÊü•ÁõÆÊ†áË¥ßÂ∏ÅÊòØÂê¶‰ªçÁÑ∂ÂèØÁî®ÔºåÂ¶ÇÊûú‰∏çÂèØÁî®ÂàôÈÄâÊã©Á¨¨‰∏Ä‰∏™ÂèØÁî®Ë¥ßÂ∏Å
        if (!availableCurrencies.includes(to) || to === from) {
          const firstAvailable = availableCurrencies.find(c => c !== from);
          if (firstAvailable) {
            document.getElementById('toCurrency').value = firstAvailable;
          }
        }

        // Êõ¥Êñ∞ÂàóË°®ÂíåÊòæÁ§∫
        renderRatesList();
        updateTimeDisplay();
        performConversion();
      });
      document.getElementById('toCurrency').addEventListener('change', performConversion);

      // ÊêúÁ¥¢ÂäüËÉΩ
      let searchTimeout;
      document.getElementById('searchInput').addEventListener('input', (e) => {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
          renderRatesList(e.target.value);
        }, 300);
      });

      // ÂÆöÊúüÊõ¥Êñ∞Ê±áÁéáÔºàÊØè5ÂàÜÈíüÔºâ
      setInterval(async () => {
        const from = document.getElementById('fromCurrency').value;
        await fetchExchangeRates(from);
        renderRatesList(document.getElementById('searchInput').value);
        updateTimeDisplay();
        performConversion();
      }, 5 * 60 * 1000);

      // ÁõëÂê¨ÊªöÂä®ÔºåÊõ¥Êñ∞Â≠óÊØçÊåáÁ§∫Âô®
      let scrollTimeout;
      window.addEventListener('scroll', () => {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(handleScroll, 100);
      });
    }

    // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
    document.addEventListener('DOMContentLoaded', init);
  </script>
  <script src="./tools.js"></script>
</body>

</html>