<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
  <link rel="stylesheet" href="./assets/css/theme.css">
  <style>
    /* ç»§æ‰¿theme.cssçš„åŸºç¡€æ ·å¼ */
    /* ä»¥ä¸‹æ˜¯é¦–é¡µç‰¹å®šçš„æ ·å¼è¦†ç›– */

    /* æœç´¢æ¡† */
    .search-container {
      margin-bottom: 30px;
      position: relative
    }

    .search-box {
      padding: var(--spacing-md) 50px var(--spacing-md) var(--spacing-lg);
      box-shadow: var(--shadow-sm);
    }

    .search-icon {
      position: absolute;
      right: var(--spacing-lg);
      top: 50%;
      transform: translateY(-50%);
      font-size: var(--font-size-large);
      color: var(--color-text-light);
      pointer-events: none;
      transition: color 0.3s;
    }

    .search-box:focus+.search-icon {
      color: var(--color-primary);
    }

    .search-results-info {
      margin-top: var(--spacing-sm);
      color: var(--color-text-secondary);
      font-size: var(--font-size-small);
      display: none;
    }

    .search-results-info.show {
      display: block
    }

    .no-results {
      text-align: center;
      padding: 60px var(--spacing-lg);
      color: var(--color-text-light);
      display: none;
    }

    .no-results.show {
      display: block
    }

    .no-results-icon {
      font-size: 64px;
      margin-bottom: 16px;
      opacity: 0.5
    }

    /* ä¸»é¢˜åˆ‡æ¢æŒ‰é’®ï¼ˆå¡ç‰‡å³ä¸Šè§’ï¼‰ */
    .theme-toggle-btn {
      position: absolute;
      top: var(--spacing-lg);
      right: var(--spacing-lg);
      width: 44px;
      height: 44px;
      background: rgba(255, 255, 255, 0.15);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-text-on-primary);
      font-size: var(--font-size-large);
      cursor: pointer;
      transition: all 0.3s;
      z-index: 10;
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .theme-toggle-btn:hover {
      background: rgba(255, 255, 255, 0.25);
      border-color: rgba(255, 255, 255, 0.5);
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    /* ä¸»é¢˜é€‰æ‹©å¼¹çª— */
    .theme-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .theme-modal.show {
      display: flex;
      opacity: 1;
    }

    .theme-modal-content {
      background: var(--color-surface);
      border-radius: var(--radius-lg);
      padding: var(--spacing-xl);
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: var(--shadow-xl);
      transform: scale(0.9);
      transition: transform 0.3s;
      border: 1px solid var(--color-border);
    }

    .theme-modal.show .theme-modal-content {
      transform: scale(1);
    }

    .theme-modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--spacing-lg);
      padding-bottom: var(--spacing-md);
      border-bottom: 2px solid var(--color-border);
    }

    .theme-modal-title {
      font-size: var(--font-size-large);
      font-weight: var(--font-weight-bold);
      color: var(--color-text);
      margin: 0;
    }

    .theme-modal-close {
      width: 32px;
      height: 32px;
      border: none;
      background: transparent;
      color: var(--color-text-secondary);
      font-size: var(--font-size-large);
      cursor: pointer;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .theme-modal-close:hover {
      background: var(--color-hover);
      color: var(--color-text);
    }

    .theme-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--spacing-md);
    }

    .theme-item {
      padding: var(--spacing-md);
      border: 2px solid var(--color-border);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.3s;
      background: var(--color-background-alt);
      position: relative;
      overflow: hidden;
    }

    .theme-item:hover {
      border-color: var(--color-primary);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .theme-item.active {
      border-color: var(--color-primary);
      background: var(--color-hover);
      box-shadow: var(--shadow-md);
    }

    .theme-item.active::before {
      content: 'âœ“';
      position: absolute;
      top: var(--spacing-xs);
      right: var(--spacing-xs);
      width: 24px;
      height: 24px;
      background: var(--color-primary);
      color: var(--color-text-on-primary);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--font-size-small);
      font-weight: var(--font-weight-bold);
    }

    .theme-item-preview {
      width: 100%;
      height: 60px;
      border-radius: var(--radius-sm);
      margin-bottom: var(--spacing-sm);
      border: 1px solid var(--color-border);
      background-size: cover;
      background-position: center;
    }

    .theme-item-name {
      font-size: var(--font-size-base);
      font-weight: var(--font-weight-semibold);
      color: var(--color-text);
      margin-bottom: var(--spacing-xs);
    }

    .theme-item-desc {
      font-size: var(--font-size-small);
      color: var(--color-text-secondary);
      line-height: 1.4;
    }

    /* å¿«æ·å…¥å£ */
    .quick-access {
      margin-top: 60px;
      padding-top: var(--spacing-xxl);
      border-top: 2px solid var(--color-border);
    }

    .quick-access-title {
      font-size: var(--font-size-large);
      color: var(--color-text);
      margin-bottom: var(--spacing-lg);
      font-weight: var(--font-weight-bold);
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }

    .quick-links {
      display: flex;
      flex-wrap: wrap;
      gap: 12px
    }

    .quick-link {
      display: inline-flex;
      align-items: center;
      gap: var(--spacing-sm);
      padding: var(--spacing-sm) var(--spacing-lg);
      background: var(--color-background-alt);
      border-radius: 24px;
      color: var(--color-text);
      text-decoration: none;
      font-size: var(--font-size-small);
      font-weight: var(--font-weight-medium);
      transition: all 0.3s;
      border: 2px solid transparent;
    }

    .quick-link:hover {
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
      color: var(--color-text-on-primary);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
      border-color: transparent;
    }

    .quick-link-icon {
      font-size: 18px
    }

    /* å·¥å…·å¡ç‰‡ç½‘æ ¼ */
    .tools-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 16px;
      margin-bottom: 24px
    }

    .tool-card {
      background: var(--color-background-alt);
      border-radius: var(--radius-md);
      padding: var(--spacing-md);
      box-shadow: var(--shadow-sm);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }

    .tool-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
      transform: scaleX(0);
      transition: transform 0.3s;
    }

    .tool-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
      border-color: var(--color-primary);
    }

    .tool-card:hover::before {
      transform: scaleX(1)
    }

    .tool-card-header {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      margin-bottom: 12px
    }

    .tool-icon-wrapper {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-md);
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      flex-shrink: 0;
      box-shadow: var(--shadow-md);
      transition: transform 0.3s;
    }

    .tool-card:hover .tool-icon-wrapper {
      transform: scale(1.1) rotate(5deg)
    }

    .tool-info {
      flex: 1;
      min-width: 0
    }

    .tool-title-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      margin-bottom: 6px
    }

    .tool-title {
      font-size: 15px;
      color: var(--color-text);
      font-weight: var(--font-weight-bold);
      line-height: 1.3;
      flex: 1;
    }

    .tool-rating {
      display: flex;
      gap: 2px;
      flex-shrink: 0
    }

    .star {
      color: #ffd700;
      font-size: 12px;
      text-shadow: 0 1px 2px rgba(0, 0, 0, .1)
    }

    .star.empty {
      color: #e2e8f0
    }

    .tool-category {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 8px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 10px
    }

    .category-dev {
      background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);
      color: #667eea
    }

    .category-image {
      background: linear-gradient(135deg, #f093fb20 0%, #f5576c20 100%);
      color: #f5576c
    }

    .category-text {
      background: linear-gradient(135deg, #4facfe20 0%, #00f2fe20 100%);
      color: #4facfe
    }

    .tool-desc {
      font-size: var(--font-size-small);
      color: var(--color-text-secondary);
      line-height: var(--line-height);
      margin-bottom: var(--spacing-sm);
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .tool-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding-top: var(--spacing-sm);
      border-top: 1px solid var(--color-border);
    }

    .tool-link {
      color: var(--color-primary);
      text-decoration: none;
      font-weight: var(--font-weight-semibold);
      font-size: 13px;
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      transition: all 0.3s;
    }

    .tool-link:hover {
      color: var(--color-primary-dark);
      gap: 10px;
    }

    .tool-link::after {
      content: 'â†’';
      transition: transform 0.3s
    }

    .tool-link:hover::after {
      transform: translateX(4px)
    }

    /* é¡µç­¾å¯¼èˆª */
    .tabs-container {
      margin-bottom: var(--spacing-lg);
      border-bottom: 2px solid var(--color-border);
      position: relative;
    }

    .tabs-nav {
      display: flex;
      flex-wrap: wrap;
      gap: var(--spacing-xs);
      margin-bottom: -2px;
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
      padding-bottom: 2px;
    }

    .tabs-nav::-webkit-scrollbar {
      display: none;
    }

    .tab-btn {
      padding: var(--spacing-md) var(--spacing-lg);
      background: transparent;
      border: none;
      border-bottom: 3px solid transparent;
      color: var(--color-text-secondary);
      font-size: var(--font-size-base);
      font-weight: var(--font-weight-semibold);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      position: relative;
      font-family: var(--font-family);
      border-radius: var(--radius-md) var(--radius-md) 0 0;
    }

    .tab-btn::before {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--color-primary);
      transform: scaleX(0);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .tab-btn:hover {
      color: var(--color-primary);
      background: var(--color-hover);
    }

    .tab-btn:hover::before {
      transform: scaleX(0.5);
    }

    .tab-btn.active {
      color: var(--color-primary);
      background: var(--color-hover);
      border-bottom-color: var(--color-primary);
    }

    .tab-btn.active::before {
      transform: scaleX(1);
    }

    .tab-btn .tab-icon {
      font-size: 18px;
      transition: transform 0.3s;
    }

    .tab-btn:hover .tab-icon {
      transform: scale(1.1);
    }

    .tab-btn.active .tab-icon {
      transform: scale(1.15);
    }

    .tab-count {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 20px;
      height: 20px;
      padding: 0 6px;
      background: var(--color-text-light);
      color: var(--color-text-on-primary);
      border-radius: 10px;
      font-size: 11px;
      font-weight: var(--font-weight-bold);
      margin-left: var(--spacing-xs);
      transition: all 0.3s;
    }

    .tab-btn:hover .tab-count {
      background: var(--color-primary);
    }

    .tab-btn.active .tab-count {
      background: var(--color-primary);
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease-in;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* åˆ†ç±»æ ‡é¢˜ï¼ˆä¿ç•™ç”¨äºå‘åå…¼å®¹ï¼Œä½†éšè—ï¼‰ */
    .section-title {
      display: none;
    }

    /* å“åº”å¼ */
    @media (max-width: 1024px) {
      .tools-grid {
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
        gap: 14px
      }
    }

    @media (max-width: 768px) {
      .tools-grid {
        grid-template-columns: 1fr;
        gap: 12px
      }

      .content {
        padding: 20px
      }

      .header {
        padding: 30px 20px
      }

      .tab-btn {
        padding: var(--spacing-sm) var(--spacing-md);
        font-size: var(--font-size-small);
      }

      .tabs-nav {
        gap: var(--spacing-xs);
      }
    }
  </style>
  <link rel="icon" href="data:,">
  <script src="./assets/js/tools.js"></script>
  <script src="./assets/js/themes.js"></script>
  <script src="./assets/js/theme-ui.js"></script>
</head>

<body>
  <div class="container">
    <div class="header">
      <button id="themeToggleBtn" class="theme-toggle-btn" title="åˆ‡æ¢ä¸»é¢˜">ğŸ¨</button>
      <h1></h1>
      <p></p>
    </div>
    <div class="content">
      <!-- æœç´¢æ¡† -->
      <div class="search-container">
        <input type="text" class="search-box" id="searchInput" placeholder="">
        <span class="search-icon">ğŸ”</span>
        <div class="search-results-info" id="searchResultsInfo"></div>
      </div>

      <!-- é¡µç­¾å¯¼èˆª -->
      <div class="tabs-container">
        <div class="tabs-nav" id="tabsNav"></div>
      </div>

      <!-- é¡µç­¾å†…å®¹ -->
      <div class="tab-content active" id="tabAll">
        <div class="tools-grid" id="allTools"></div>
      </div>

      <div class="tab-content" id="tabDev">
        <div class="tools-grid" id="devTools"></div>
      </div>

      <div class="tab-content" id="tabImage">
        <div class="tools-grid" id="imageTools"></div>
      </div>

      <div class="tab-content" id="tabText">
        <div class="tools-grid" id="textTools"></div>
      </div>

      <div class="tab-content" id="tabConverter">
        <div class="tools-grid" id="converterTools"></div>
      </div>

      <div class="tab-content" id="tabWriting">
        <div class="tools-grid" id="writingTools"></div>
      </div>

      <div class="tab-content" id="tabLife">
        <div class="tools-grid" id="lifeTools"></div>
      </div>

      <div class="tab-content" id="tabSearch">
        <div class="tools-grid" id="searchTools"></div>
      </div>

      <!-- ä¿ç•™åŸæœ‰åˆ†ç±»æ ‡é¢˜ï¼ˆéšè—ï¼‰ç”¨äºå‘åå…¼å®¹ -->
      <div class="section-title" id="devSection" style="display: none;">
        <span class="section-icon">ğŸ’»</span>
        <span id="devSectionTitle"></span>
      </div>
      <div class="section-title" id="imageSection" style="display: none;">
        <span class="section-icon">ğŸ–¼ï¸</span>
        <span id="imageSectionTitle"></span>
      </div>
      <div class="section-title" id="textSection" style="display: none;">
        <span class="section-icon">ğŸ“</span>
        <span id="textSectionTitle"></span>
      </div>
      <div class="section-title" id="unitSection" style="display: none;">
        <span class="section-icon">ğŸ“</span>
        <span id="unitSectionTitle"></span>
      </div>

      <!-- æ— ç»“æœæç¤º -->
      <div class="no-results" id="noResults">
        <div class="no-results-icon">ğŸ”</div>
        <div style="font-size: 18px; margin-bottom: 8px;"></div>
        <div></div>
      </div>

      <!-- å¿«æ·å…¥å£ -->
      <div class="quick-access">
        <div class="quick-access-title">
          <span>âš¡</span>
          <span></span>
        </div>
        <div class="quick-links" id="quickLinks"></div>
      </div>
    </div>
  </div>

  <script>
    // å·¥å…·æ•°æ®å’Œé…ç½®ï¼ˆä» tools.js åŠ è½½ï¼‰
    let tools = [];
    let categories = {};
    let currentLang = 'zh';
    let activeTab = 'all';
    let previousTab = 'all'; // ä¿å­˜æœç´¢å‰çš„é¡µç­¾
    let currentSearchQuery = '';

    // åˆå§‹åŒ–å·¥å…·æ•°æ®
    function initToolsData() {
      if (typeof window.toolsData === 'undefined') {
        console.error('tools.js æœªåŠ è½½');
        return false;
      }
      tools = window.toolsData.tools || [];
      categories = window.toolsData.categories || {};
      currentLang = window.getLanguage();
      return true;
    }

    // è·å–é¦–é¡µé…ç½®æ–‡æœ¬
    function getHomeConfig(field) {
      if (!window.homeConfig || !window.homeConfig[field]) return '';
      const value = window.homeConfig[field];
      return typeof value === 'object' ? (value[currentLang] || value.zh || '') : value;
    }

    // è·å–å·¥å…·æ˜¾ç¤ºæ–‡æœ¬
    function getToolText(tool, field) {
      if (!tool || !tool[field]) return '';
      const value = tool[field];
      if (typeof value === 'object' && value !== null) {
        return value[currentLang] || value.zh || value.en || '';
      }
      return value || '';
    }

    // è·å–åˆ†ç±»åç§°
    function getCategoryName(category) {
      if (!categories[category]) return category;
      const cat = categories[category];
      return typeof cat === 'object' ? (cat[currentLang] || cat.zh || category) : cat;
    }

    // ç”Ÿæˆæ˜Ÿçº§
    function generateStars(rating) {
      let stars = '';
      for (let i = 1; i <= 5; i++) {
        stars += `<span class="star ${i <= rating ? '' : 'empty'}">â˜…</span>`;
      }
      return stars;
    }

    // è·å–åˆ†ç±»åç§°
    function getCategoryClass(category) {
      const classes = {
        dev: 'category-dev',
        image: 'category-image',
        text: 'category-text'
      };
      return classes[category] || 'category-dev';
    }

    // è·å–å·¥å…·åˆ†ç±»æ˜¾ç¤ºåç§°
    function getToolCategoryName(tool) {
      return getCategoryName(tool.category);
    }

    // åˆ›å»ºå¡ç‰‡
    function createCard(tool) {
      const title = getToolText(tool, 'title');
      const desc = getToolText(tool, 'desc');
      const categoryName = getToolCategoryName(tool);

      return `
        <div class="tool-card" onclick="window.location.href='${tool.href}'">
          <div class="tool-card-header">
            <div class="tool-icon-wrapper">${tool.icon}</div>
            <div class="tool-info">
              <div class="tool-title-row">
                <div class="tool-title">${title}</div>
                <div class="tool-rating">${generateStars(tool.rating)}</div>
              </div>
              <span class="tool-category ${getCategoryClass(tool.category)}">${categoryName}</span>
            </div>
          </div>
          <div class="tool-desc">${desc}</div>
          <div class="tool-footer">
            <a href="${tool.href}" class="tool-link">${currentLang === 'en' ? 'Use Now' : 'ç«‹å³ä½¿ç”¨'}</a>
          </div>
        </div>
      `;
    }

    // åˆ‡æ¢é¡µç­¾
    function switchTab(tabId) {
      // æ›´æ–°æ´»åŠ¨é¡µç­¾ï¼ˆæœç´¢é¡µç­¾ä¸æ›´æ–°activeTabï¼Œä¿æŒåŸé¡µç­¾ï¼‰
      if (tabId !== 'search') {
        activeTab = tabId;
      }

      // æ›´æ–°é¡µç­¾æŒ‰é’®çŠ¶æ€ï¼ˆæœç´¢æ—¶ä¸æ›´æ–°æŒ‰é’®çŠ¶æ€ï¼‰
      if (tabId !== 'search') {
        const tabButtons = document.querySelectorAll('.tab-btn');
        tabButtons.forEach(btn => {
          if (btn.dataset.tab === tabId) {
            btn.classList.add('active');
          } else {
            btn.classList.remove('active');
          }
        });
      }

      // æ›´æ–°é¡µç­¾å†…å®¹æ˜¾ç¤º
      const tabContents = document.querySelectorAll('.tab-content');
      tabContents.forEach(content => {
        // å°† tabAll, tabDev ç­‰è½¬æ¢ä¸ºå¯¹åº”çš„ tabId
        let contentTabId = content.id.replace('tab', '');
        // é¦–å­—æ¯å°å†™ï¼šAll -> all, Dev -> dev
        contentTabId = contentTabId.charAt(0).toLowerCase() + contentTabId.slice(1);

        if (contentTabId === tabId) {
          content.classList.add('active');
        } else {
          content.classList.remove('active');
        }
      });

      // å¦‚æœæ²¡æœ‰æœç´¢æŸ¥è¯¢ï¼Œæ¸²æŸ“å¯¹åº”é¡µç­¾çš„å·¥å…·
      if (!currentSearchQuery && tabId !== 'search') {
        renderToolsByTab(tabId);
      }
    }

    // æ ¹æ®é¡µç­¾æ¸²æŸ“å·¥å…·
    function renderToolsByTab(tabId) {
      const allTools = document.getElementById('allTools');
      const devTools = document.getElementById('devTools');
      const imageTools = document.getElementById('imageTools');
      const textTools = document.getElementById('textTools');
      const converterTools = document.getElementById('converterTools');
      const writingTools = document.getElementById('writingTools');
      const lifeTools = document.getElementById('lifeTools');
      const noResults = document.getElementById('noResults');
      const searchResultsInfo = document.getElementById('searchResultsInfo');

      // æ¸…ç©ºæ‰€æœ‰å®¹å™¨
      if (allTools) allTools.innerHTML = '';
      if (devTools) devTools.innerHTML = '';
      if (imageTools) imageTools.innerHTML = '';
      if (textTools) textTools.innerHTML = '';
      if (converterTools) converterTools.innerHTML = '';
      if (writingTools) writingTools.innerHTML = '';
      if (lifeTools) lifeTools.innerHTML = '';

      let toolsToRender = [];

      if (tabId === 'all') {
        toolsToRender = tools;
      } else if (tabId === 'dev') {
        toolsToRender = tools.filter(t => t.category === 'dev');
      } else if (tabId === 'image') {
        toolsToRender = tools.filter(t => t.category === 'image');
      } else if (tabId === 'text') {
        toolsToRender = tools.filter(t => t.category === 'text');
      } else if (tabId === 'converter') {
        toolsToRender = tools.filter(t => t.category === 'converter');
      } else if (tabId === 'writing') {
        toolsToRender = tools.filter(t => t.category === 'writing');
      } else if (tabId === 'life') {
        toolsToRender = tools.filter(t => t.category === 'life');
      }

      let hasResults = false;

      toolsToRender.forEach(tool => {
        if (!tool || !tool.category) {
          console.warn('å·¥å…·æ•°æ®æ ¼å¼é”™è¯¯:', tool);
          return;
        }
        try {
          const card = createCard(tool);
          if (tabId === 'all') {
            allTools.innerHTML += card;
            hasResults = true;
          } else if (tabId === 'dev') {
            devTools.innerHTML += card;
            hasResults = true;
          } else if (tabId === 'image') {
            imageTools.innerHTML += card;
            hasResults = true;
          } else if (tabId === 'text') {
            textTools.innerHTML += card;
            hasResults = true;
          } else if (tabId === 'converter') {
            converterTools.innerHTML += card;
            hasResults = true;
          } else if (tabId === 'writing') {
            writingTools.innerHTML += card;
            hasResults = true;
          } else if (tabId === 'life') {
            lifeTools.innerHTML += card;
            hasResults = true;
          }
        } catch (error) {
          console.error('åˆ›å»ºå·¥å…·å¡ç‰‡å¤±è´¥:', tool, error);
        }
      });

      // æ˜¾ç¤º/éšè—æ— ç»“æœæç¤º
      if (noResults) {
        noResults.classList.toggle('show', !hasResults);
      }

      // éšè—æœç´¢ç»“æœä¿¡æ¯
      if (searchResultsInfo) {
        searchResultsInfo.classList.remove('show');
      }
    }

    // æ¸²æŸ“æœç´¢ç»“æœ
    function renderSearchResults(filteredTools) {
      const allTools = document.getElementById('allTools');
      const noResults = document.getElementById('noResults');
      const searchResultsInfo = document.getElementById('searchResultsInfo');

      if (!allTools) {
        console.error('å·¥å…·å®¹å™¨æœªæ‰¾åˆ°');
        return;
      }

      // ä¿å­˜å½“å‰é¡µç­¾ï¼ˆå¦‚æœä¸æ˜¯æœç´¢çŠ¶æ€ï¼‰
      if (!currentSearchQuery) {
        previousTab = activeTab;
      }

      // åˆ‡æ¢åˆ°"å…¨éƒ¨"é¡µç­¾
      switchTab('all');

      // æ¸…ç©ºæœç´¢ç»“æœ
      allTools.innerHTML = '';

      if (!filteredTools || filteredTools.length === 0) {
        if (noResults) {
          noResults.classList.add('show');
        }
        if (searchResultsInfo) {
          searchResultsInfo.classList.remove('show');
        }
        return;
      }

      let hasResults = false;

      filteredTools.forEach(tool => {
        if (!tool || !tool.category) {
          console.warn('å·¥å…·æ•°æ®æ ¼å¼é”™è¯¯:', tool);
          return;
        }
        try {
          const card = createCard(tool);
          allTools.innerHTML += card;
          hasResults = true;
        } catch (error) {
          console.error('åˆ›å»ºå·¥å…·å¡ç‰‡å¤±è´¥:', tool, error);
        }
      });

      // æ˜¾ç¤ºæœç´¢ç»“æœä¿¡æ¯
      if (searchResultsInfo && filteredTools.length > 0) {
        searchResultsInfo.textContent = currentLang === 'en'
          ? `æ‰¾åˆ° ${filteredTools.length} ä¸ªå·¥å…·`
          : `æ‰¾åˆ° ${filteredTools.length} ä¸ªå·¥å…·`;
        searchResultsInfo.classList.add('show');
      }

      // æ˜¾ç¤º/éšè—æ— ç»“æœæç¤º
      if (noResults) {
        noResults.classList.toggle('show', !hasResults);
      }
    }

    // è·å–é¡µç­¾çš„å·¥å…·æ•°é‡
    function getTabToolCount(tabId) {
      if (tabId === 'all') {
        return tools.length;
      } else if (tabId === 'dev') {
        return tools.filter(t => t.category === 'dev').length;
      } else if (tabId === 'image') {
        return tools.filter(t => t.category === 'image').length;
      } else if (tabId === 'text') {
        return tools.filter(t => t.category === 'text').length;
      } else if (tabId === 'converter') {
        return tools.filter(t => t.category === 'converter').length;
      } else if (tabId === 'writing') {
        return tools.filter(t => t.category === 'writing').length;
      } else if (tabId === 'life') {
        return tools.filter(t => t.category === 'life').length;
      }
      return 0;
    }

    // æ›´æ–°é¡µç­¾æ•°é‡æ˜¾ç¤º
    function updateTabCounts() {
      const tabButtons = document.querySelectorAll('.tab-btn');
      tabButtons.forEach(btn => {
        const tabId = btn.dataset.tab;
        if (tabId) {
          const count = getTabToolCount(tabId);
          let countEl = btn.querySelector('.tab-count');
          if (!countEl) {
            countEl = document.createElement('span');
            countEl.className = 'tab-count';
            btn.appendChild(countEl);
          }
          countEl.textContent = count;
        }
      });
    }

    // åˆå§‹åŒ–é¡µç­¾
    function initTabs() {
      const tabsNav = document.getElementById('tabsNav');
      if (!tabsNav) {
        console.error('é¡µç­¾å¯¼èˆªå®¹å™¨æœªæ‰¾åˆ°');
        return;
      }

      const tabConfigs = [
        { id: 'all', icon: 'ğŸŒŸ', name: { zh: 'å…¨éƒ¨', en: 'All' } },
        { id: 'dev', icon: 'ğŸ’»', name: { zh: 'å¼€å‘å·¥å…·', en: 'Development Tools' } },
        { id: 'image', icon: 'ğŸ–¼ï¸', name: { zh: 'å›¾ç‰‡å·¥å…·', en: 'Image Tools' } },
        { id: 'text', icon: 'ğŸ“', name: { zh: 'æ–‡æœ¬å·¥å…·', en: 'Text Tools' } },
        { id: 'converter', icon: 'ğŸ”„', name: { zh: 'è½¬æ¢å·¥å…·', en: 'Converter Tools' } },
        { id: 'writing', icon: 'âœï¸', name: { zh: 'å†™ä½œå·¥å…·', en: 'Writing Tools' } },
        { id: 'life', icon: 'ğŸŒ', name: { zh: 'ç”Ÿæ´»å·¥å…·', en: 'Life Tools' } }
      ];

      tabsNav.innerHTML = '';

      tabConfigs.forEach(tab => {
        const button = document.createElement('button');
        button.className = 'tab-btn';
        button.dataset.tab = tab.id;
        if (tab.id === 'all') {
          button.classList.add('active');
        }
        const tabName = typeof tab.name === 'object' ? (tab.name[currentLang] || tab.name.zh) : tab.name;
        const count = getTabToolCount(tab.id);
        button.innerHTML = `<span class="tab-icon">${tab.icon}</span><span>${tabName}</span><span class="tab-count">${count}</span>`;
        button.addEventListener('click', () => {
          currentSearchQuery = '';
          previousTab = tab.id; // æ›´æ–°ä¹‹å‰çš„é¡µç­¾
          const searchInput = document.getElementById('searchInput');
          if (searchInput) {
            searchInput.value = '';
          }
          switchTab(tab.id);
        });
        tabsNav.appendChild(button);
      });
    }

    // æ¸²æŸ“å·¥å…·ï¼ˆä¿ç•™ç”¨äºå‘åå…¼å®¹ï¼Œä½†å·²é‡æ„ï¼‰
    function renderTools(filteredTools = null) {
      if (filteredTools) {
        // æœ‰æœç´¢æŸ¥è¯¢ï¼Œæ˜¾ç¤ºæœç´¢ç»“æœ
        currentSearchQuery = document.getElementById('searchInput')?.value || '';
        renderSearchResults(filteredTools);
      } else {
        // æ— æœç´¢æŸ¥è¯¢ï¼Œæ ¹æ®å½“å‰é¡µç­¾æ¸²æŸ“
        currentSearchQuery = '';
        renderToolsByTab(activeTab);
      }
    }

    // æ¨¡ç³Šæœç´¢ï¼ˆæ”¯æŒä¸­è‹±æ–‡ã€åå­—ã€è¯¦ç»†ä»‹ç»å’Œå…³é”®è¯ï¼‰
    function fuzzySearch(query) {
      if (!query || query.trim() === '') {
        return tools;
      }

      const lowerQuery = query.toLowerCase().trim();
      const queryWords = lowerQuery.split(/\s+/).filter(w => w.length > 0);

      return tools.filter(tool => {
        // è·å–å·¥å…·çš„æ‰€æœ‰æ–‡æœ¬å†…å®¹ï¼ˆä¸­è‹±æ–‡ï¼‰
        const titleZh = getToolText(tool, 'title');
        const titleEn = (tool.title && typeof tool.title === 'object') ? (tool.title.en || '') : '';
        const descZh = getToolText(tool, 'desc');
        const descEn = (tool.desc && typeof tool.desc === 'object') ? (tool.desc.en || '') : '';
        const keywords = tool.keywords || {};
        const keywordsZh = keywords.zh || [];
        const keywordsEn = keywords.en || [];

        // æ„å»ºæœç´¢æ–‡æœ¬ï¼ˆåŒ…å«æ‰€æœ‰ä¸­è‹±æ–‡å†…å®¹ï¼‰
        const searchText = (
          titleZh + ' ' + titleEn + ' ' +
          descZh + ' ' + descEn + ' ' +
          keywordsZh.join(' ') + ' ' +
          keywordsEn.join(' ')
        ).toLowerCase();

        // æœç´¢æ ‡é¢˜ï¼ˆä¸­è‹±æ–‡ï¼‰
        const titleMatch = queryWords.some(word =>
          titleZh.toLowerCase().includes(word) ||
          titleEn.toLowerCase().includes(word)
        ) || titleZh.toLowerCase().includes(lowerQuery) ||
          titleEn.toLowerCase().includes(lowerQuery);

        // æœç´¢æè¿°ï¼ˆä¸­è‹±æ–‡ï¼‰
        const descMatch = queryWords.some(word =>
          descZh.toLowerCase().includes(word) ||
          descEn.toLowerCase().includes(word)
        ) || descZh.toLowerCase().includes(lowerQuery) ||
          descEn.toLowerCase().includes(lowerQuery);

        // æœç´¢å…³é”®è¯ï¼ˆä¸­è‹±æ–‡ï¼‰
        const keywordMatch = queryWords.some(word =>
          keywordsZh.some(kw => kw.toLowerCase().includes(word) || word.includes(kw.toLowerCase())) ||
          keywordsEn.some(kw => kw.toLowerCase().includes(word) || word.includes(kw.toLowerCase()))
        ) || keywordsZh.some(kw => kw.toLowerCase().includes(lowerQuery)) ||
          keywordsEn.some(kw => kw.toLowerCase().includes(lowerQuery));

        // æœç´¢åˆ†ç±»
        const categoryName = getCategoryName(tool.category);
        const categoryMatch = categoryName.toLowerCase().includes(lowerQuery);

        // ä¸­æ–‡æ‹¼éŸ³é¦–å­—æ¯æœç´¢
        const pinyinMatch = titleZh.match(/[\u4e00-\u9fa5]/g)?.some(char => {
          const pinyin = getPinyinInitial(char);
          return pinyin && (pinyin.toLowerCase().includes(lowerQuery) || lowerQuery.includes(pinyin.toLowerCase()));
        });

        // å…¨æ–‡æœç´¢ï¼ˆåŒ…å«æ‰€æœ‰å†…å®¹ï¼‰
        const fullTextMatch = searchText.includes(lowerQuery) ||
          queryWords.every(word => searchText.includes(word));

        return titleMatch || descMatch || keywordMatch || categoryMatch || pinyinMatch || fullTextMatch;
      });
    }

    // è·å–ä¸­æ–‡æ‹¼éŸ³é¦–å­—æ¯ï¼ˆæ‰©å±•ç‰ˆï¼‰
    function getPinyinInitial(char) {
      const pinyinMap = {
        'å®‰': 'a', 'ç­¾': 'q', 'å': 'm', 'æ–‡': 'w', 'ä»¶': 'j', 'ç”Ÿ': 's', 'æˆ': 'c', 'å·¥': 'g', 'å…·': 'j',
        'ä¿¡': 'x', 'æ¯': 'x', 'æ': 't', 'å–': 'q', 'è°ƒ': 'd', 'è¯•': 's', 'æ ¼': 'g', 'å¼': 's', 'åŒ–': 'h',
        'è½¬': 'z', 'æ¨¡': 'm', 'å‹': 'x', 'é¢„': 'y', 'è§ˆ': 'l', 'å‹': 'y', 'ç¼©': 's', 'å¯': 'q', 'åŠ¨': 'd',
        'å›¾': 't', 'æ ‡': 'b', 'å‚': 'c', 'äº’': 'h', 'å­—': 'z', 'ä¸²': 'c', 'åŠ ': 'j', 'è§£': 'j',
        'å¯†': 'm', 'æ—¶': 's', 'é—´': 'j', 'æˆ³': 'c', 'å¤š': 'd', 'ç§': 'z', 'é¢œ': 'y', 'è‰²': 's', 'ç ': 'm',
        'æ¡': 't', 'å½¢': 'x', 'å•': 'd', 'ä½': 'w', 'é•¿': 'c', 'åº¦': 'd', 'é‡': 'z', 'é‡': 'l',
        'æ¸©': 'w', 'é¢': 'm', 'ç§¯': 'j', 'ä½“': 't', 'é€Ÿ': 's', 'æ•°': 's', 'æ®': 'j', 'è§’': 'j',
        'å‹': 'y', 'åŠ›': 'l', 'æœº': 'j', 'å‹': 'x', 'ä¿¡': 'x', 'æ¯': 'x', 'ç”Ÿ': 's', 'æˆ': 'g',
        'å™¨': 'q', 'å‹': 'y', 'ç¼©': 's', 'å¯': 'q', 'åŠ¨': 'd', 'å›¾': 't', 'æ ‡': 'b', 'å·¥': 'g',
        'å‚': 'c', 'äº’': 'h', 'è½¬': 'z', 'å­—': 'z', 'ä¸²': 'c', 'åŠ ': 'j', 'è§£': 'j', 'å¯†': 'm',
        'æ—¶': 's', 'é—´': 'j', 'æˆ³': 'c', 'å¤š': 'd', 'ç§': 'z', 'é¢œ': 'y', 'è‰²': 's', 'ç ': 'm'
      };
      return pinyinMap[char] || '';
    }

    // åˆå§‹åŒ–å¿«æ·å…¥å£
    function initQuickLinks() {
      const quickLinks = document.getElementById('quickLinks');
      quickLinks.innerHTML = '';
      // ä»é…ç½®ä¸­è·å–æ¨èå·¥å…·çš„è¯„åˆ†é˜ˆå€¼å’Œæ•°é‡é™åˆ¶
      const ratingThreshold = window.homeConfig?.quickAccessRating || 0;
      const limit = window.homeConfig?.quickAccessLimit || 0;

      // å¦‚æœè¯„åˆ†é˜ˆå€¼ä¸º0ï¼Œæ˜¾ç¤ºæ‰€æœ‰å·¥å…·ï¼›å¦åˆ™æŒ‰è¯„åˆ†è¿‡æ»¤
      let popularTools = ratingThreshold > 0
        ? tools.filter(t => t.rating >= ratingThreshold)
        : tools;

      // å¦‚æœæ•°é‡é™åˆ¶ä¸º0ï¼Œæ˜¾ç¤ºæ‰€æœ‰å·¥å…·ï¼›å¦åˆ™é™åˆ¶æ•°é‡
      if (limit > 0) {
        popularTools = popularTools.slice(0, limit);
      }

      popularTools.forEach(tool => {
        const link = document.createElement('a');
        link.href = tool.href;
        link.className = 'quick-link';
        const title = getToolText(tool, 'title');
        link.innerHTML = `<span class="quick-link-icon">${tool.icon}</span><span>${title}</span>`;
        quickLinks.appendChild(link);
      });
    }

    // åˆå§‹åŒ–åº”ç”¨
    function initApp() {
      if (!initToolsData()) {
        console.error('å·¥å…·æ•°æ®åˆå§‹åŒ–å¤±è´¥');
        return;
      }
      console.log('åˆå§‹åŒ–åº”ç”¨ï¼Œå·¥å…·æ•°é‡:', tools.length);
      initTabs();
      updateTabCounts(); // æ›´æ–°é¡µç­¾æ•°é‡æ˜¾ç¤º
      renderTools();
      initQuickLinks();

      // æ›´æ–°é¡µé¢æ ‡é¢˜
      document.title = getHomeConfig('title');

      // æ›´æ–°æœç´¢æ¡†å ä½ç¬¦
      const searchInput = document.getElementById('searchInput');
      if (searchInput) {
        searchInput.placeholder = getHomeConfig('searchPlaceholder');
      }

      // æ›´æ–°é¡µé¢æ ‡é¢˜å’Œæè¿°
      const headerTitle = document.querySelector('.header h1');
      const headerDesc = document.querySelector('.header p');
      if (headerTitle) {
        headerTitle.textContent = getHomeConfig('title');
      }
      if (headerDesc) {
        headerDesc.textContent = getHomeConfig('description');
      }

      // æ›´æ–°å¿«æ·å…¥å£æ ‡é¢˜
      const quickAccessTitle = document.querySelector('.quick-access-title');
      if (quickAccessTitle) {
        const text = quickAccessTitle.querySelector('span:last-child');
        if (text) {
          text.textContent = getHomeConfig('quickAccessTitle');
        }
      }

      // æ›´æ–°æ— ç»“æœæç¤º
      const noResults = document.getElementById('noResults');
      if (noResults) {
        const noResultsText = noResults.querySelector('div:last-child');
        if (noResultsText) {
          noResultsText.textContent = getHomeConfig('noResultsText');
        }
        const noResultsTitle = noResults.querySelector('div:nth-child(2)');
        if (noResultsTitle) {
          noResultsTitle.textContent = getHomeConfig('noResultsTitle');
        }
      }
    }

    // æœç´¢äº‹ä»¶ç›‘å¬
    let searchTimeout;
    document.addEventListener('DOMContentLoaded', () => {
      // åˆå§‹åŒ–å·¥å…·æ•°æ®
      if (initToolsData()) {
        initApp();
      }

      const searchInput = document.getElementById('searchInput');
      if (searchInput) {
        searchInput.addEventListener('input', (e) => {
          clearTimeout(searchTimeout);
          searchTimeout = setTimeout(() => {
            const query = e.target.value.trim();
            currentSearchQuery = query;
            if (query) {
              const results = fuzzySearch(query);
              renderSearchResults(results);
            } else {
              // æ¸…ç©ºæœç´¢ï¼Œå›åˆ°æœç´¢å‰çš„é¡µç­¾
              const searchResultsInfo = document.getElementById('searchResultsInfo');
              if (searchResultsInfo) {
                searchResultsInfo.classList.remove('show');
              }
              // è¿”å›åˆ°æœç´¢å‰é€‰ä¸­çš„é¡µç­¾ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨å½“å‰é¡µç­¾
              const tabToReturn = previousTab || activeTab;
              switchTab(tabToReturn);
            }
          }, 300);
        });

        // æ”¯æŒé”®ç›˜å¿«æ·é”® Ctrl/Cmd + K èšç„¦æœç´¢æ¡†
        document.addEventListener('keydown', (e) => {
          if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
            e.preventDefault();
            searchInput.focus();
          }
        });
      }
    });
  </script>
</body>

</html>