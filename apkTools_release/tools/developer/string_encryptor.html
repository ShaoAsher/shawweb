<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å­—ç¬¦ä¸²åŠ è§£å¯†å·¥å…·</title>
  <link rel="stylesheet" href="../../assets/css/theme.css">
  <style>
    /* ç»§æ‰¿theme.cssçš„åŸºç¡€æ ·å¼ */
    /* ä»¥ä¸‹æ˜¯å·¥å…·é¡µé¢ç‰¹å®šçš„æ ·å¼è¦†ç›– */

    .container {
      max-width: 1200px;
    }

    .home-btn {
      position: absolute;
      top: var(--spacing-lg);
      left: var(--spacing-lg);
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.2);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-text-on-primary);
      text-decoration: none;
      font-size: var(--font-size-large);
      transition: all .3s;
      z-index: 10;
    }

    .home-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      border-color: rgba(255, 255, 255, 0.5);
      transform: scale(1.1);
    }

    .header h1 {
      font-size: var(--font-size-xlarge);
      margin-bottom: var(--spacing-sm);
    }

    .header p {
      opacity: .9;
      font-size: var(--font-size-small);
    }

    .content {
      padding: var(--spacing-xl);
    }

    .form-section {
      background: var(--color-background-alt);
      border-radius: var(--radius-md);
      padding: var(--spacing-lg);
      margin-bottom: var(--spacing-lg);
    }

    .form-section h2 {
      font-size: var(--font-size-large);
      color: var(--color-text);
      margin-bottom: var(--spacing-lg);
      border-bottom: 2px solid var(--color-primary);
      padding-bottom: var(--spacing-sm);
    }

    .controls-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--spacing-md);
      margin-top: var(--spacing-xl);
    }

    .form-group {
      margin-bottom: var(--spacing-lg);
    }

    .form-group label {
      display: block;
      font-weight: var(--font-weight-semibold);
      color: var(--color-text);
      margin-bottom: var(--spacing-sm);
      font-size: var(--font-size-small);
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: var(--spacing-sm);
      border: 2px solid var(--color-border);
      border-radius: var(--radius-sm);
      font-size: var(--font-size-small);
      font-family: inherit;
      background: var(--color-surface);
      color: var(--color-text);
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 4px var(--color-shadow-primary);
    }

    .form-group textarea {
      min-height: 120px;
      resize: vertical;
    }

    .btn {
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
      color: var(--color-text-on-primary);
      border: none;
      padding: var(--spacing-sm) var(--spacing-xl);
      border-radius: var(--radius-sm);
      font-size: var(--font-size-base);
      font-weight: var(--font-weight-semibold);
      cursor: pointer;
      transition: transform .2s;
      width: 100%;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .btn:disabled {
      opacity: .6;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
      margin-top: 10px
    }

    .status {
      display: none;
      margin-top: 12px;
      padding: 10px;
      border-radius: 8px
    }

    .status.show {
      display: block
    }

    .status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb
    }

    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb
    }

    .result-area {
      background: var(--color-surface);
      border: 2px solid #dee2e6;
      border-radius: var(--radius-sm);
      padding: var(--spacing-md);
      min-height: 120px;
      word-break: break-all;
      white-space: pre-wrap;
      font-family: 'Courier New', monospace;
      font-size: var(--font-size-small);
      user-select: text;
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text
    }

    .input-box-wrapper,
    .output-box-wrapper {
      background: var(--color-surface);
      border: 2px solid #dee2e6;
      border-radius: var(--radius-md);
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px
    }

    .input-box-wrapper .form-group,
    .output-box-wrapper .form-group {
      margin-bottom: 0;
      flex: 1;
      display: flex;
      flex-direction: column
    }

    .input-box-wrapper textarea,
    .output-box-wrapper .result-area {
      flex: 1;
      min-height: 250px;
      border: 1px solid var(--color-border);
      border-radius: 8px
    }

    .input-box-buttons,
    .output-box-buttons {
      display: flex;
      gap: 12px;
      padding-top: 10px;
      border-top: 1px solid #f0f0f0
    }

    .input-box-buttons .btn {
      flex: 1;
      padding: 12px 20px;
      font-size: 14px
    }

    .output-box-buttons .btn {
      width: 100%;
      padding: 12px 20px;
      font-size: 14px
    }

    .input-output-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px
    }


    .action-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 10px
    }

    .action-buttons .btn {
      flex: 1
    }

    .btn-encrypt {
      background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
      color: var(--color-text-on-primary);
      border: none
    }

    .btn-encrypt:hover {
      background: linear-gradient(135deg, #ff8a8e 0%, #febfdf 50%, #febfdf 100%);
      box-shadow: 0 5px 15px rgba(255, 154, 158, .4);
      transform: translateY(-2px)
    }

    .btn-decrypt {
      background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      color: var(--color-text-on-primary);
      border: none
    }

    .btn-decrypt:hover {
      background: linear-gradient(135deg, #98ddd8 0%, #fec6d3 100%);
      box-shadow: 0 5px 15px rgba(168, 237, 234, .4);
      transform: translateY(-2px)
    }


    @media (max-width: 768px) {
      .input-output-grid {
        grid-template-columns: 1fr
      }
    }

    .algorithm-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px
    }

    .tab-btn {
      background: var(--color-surface-alt);
      color: #495057;
      border: 2px solid #dee2e6;
      padding: 10px 20px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-weight: 600;
      transition: all .2s
    }

    .tab-btn.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: var(--color-text-on-primary);
      border-color: #667eea
    }

    .tab-content {
      display: none
    }

    .tab-content.active {
      display: block
    }

    .info-text {
      color: var(--color-text-secondary);
      font-size: var(--font-size-small);
      margin-top: 5px
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <a href="../../index.html" class="home-btn" title="è¿”å›é¦–é¡µ">ğŸ </a>
      <h1>ğŸ” å­—ç¬¦ä¸²åŠ è§£å¯†å·¥å…·</h1>
      <p>æ”¯æŒå¤šç§ä¸»æµåŠ è§£å¯†ç®—æ³•å’Œç¼–ç æ–¹å¼</p>
    </div>
    <div class="content">
      <div class="form-section">
        <h2>é€‰æ‹©ç®—æ³•</h2>
        <div class="algorithm-tabs" id="algorithmTabs"></div>
      </div>

      <div class="form-section">
        <h2>åŠ å¯†å‚æ•°</h2>
        <div class="controls-grid" id="algorithmControls"></div>
      </div>

      <div class="form-section">
        <h2>è¾“å…¥ä¸è¾“å‡º</h2>
        <div class="input-output-grid">
          <div class="input-box-wrapper">
            <div class="form-group">
              <label for="inputText"
                style="font-weight:var(--font-weight-semibold);color:var(--color-text);margin-bottom:var(--spacing-sm)">è¾“å…¥æ–‡æœ¬</label>
              <textarea id="inputText" placeholder="è¯·è¾“å…¥è¦åŠ å¯†/è§£å¯†çš„å†…å®¹..."></textarea>
            </div>
            <div class="input-box-buttons">
              <button class="btn btn-secondary" id="clearBtn">ğŸ—‘ï¸ æ¸…ç©º</button>
              <button class="btn btn-encrypt" id="encryptBtn">ğŸ”’ åŠ å¯†</button>
              <button class="btn btn-decrypt" id="decryptBtn">ğŸ”“ è§£å¯†</button>
            </div>
          </div>
          <div class="output-box-wrapper">
            <div class="form-group">
              <label for="outputText"
                style="font-weight:var(--font-weight-semibold);color:var(--color-text);margin-bottom:var(--spacing-sm)">è¾“å‡ºç»“æœ</label>
              <div class="result-area" id="outputText" contenteditable="false"></div>
            </div>
            <div class="output-box-buttons">
              <button class="btn btn-secondary" id="copyBtn">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
            </div>
          </div>
        </div>
        <div class="status" id="status"></div>
      </div>
    </div>
  </div>

  <script>
    const algorithms = {
      base64: { name: 'Base64', type: 'encode', needsKey: false },
      url: { name: 'URL ç¼–ç ', type: 'encode', needsKey: false },
      html: { name: 'HTML å®ä½“', type: 'encode', needsKey: false },
      hex: { name: 'Hex ç¼–ç ', type: 'encode', needsKey: false },
      unicode: { name: 'Unicode ç¼–ç ', type: 'encode', needsKey: false },
      md5: { name: 'MD5 å“ˆå¸Œ', type: 'hash', needsKey: false },
      sha1: { name: 'SHA-1 å“ˆå¸Œ', type: 'hash', needsKey: false },
      sha256: { name: 'SHA-256 å“ˆå¸Œ', type: 'hash', needsKey: false },
      sha512: { name: 'SHA-512 å“ˆå¸Œ', type: 'hash', needsKey: false },
      aes: { name: 'AES åŠ å¯†', type: 'crypto', needsKey: true, hasOptions: true },
      caesar: { name: 'å‡¯æ’’å¯†ç ', type: 'crypto', needsKey: true },
      morse: { name: 'æ‘©æ–¯å¯†ç ', type: 'encode', needsKey: false }
    };

    const algorithmTabs = document.getElementById('algorithmTabs');
    const algorithmControls = document.getElementById('algorithmControls');
    const inputText = document.getElementById('inputText');
    const outputText = document.getElementById('outputText');
    const encryptBtn = document.getElementById('encryptBtn');
    const decryptBtn = document.getElementById('decryptBtn');
    const clearBtn = document.getElementById('clearBtn');
    const copyBtn = document.getElementById('copyBtn');
    const status = document.getElementById('status');

    let currentAlgorithm = 'base64';

    function showStatus(text, type) {
      status.textContent = text;
      status.className = 'status show ' + (type || 'success');
      setTimeout(() => status.classList.remove('show'), 3000);
    }

    function initTabs() {
      Object.keys(algorithms).forEach(key => {
        const btn = document.createElement('button');
        btn.className = 'tab-btn' + (key === currentAlgorithm ? ' active' : '');
        btn.textContent = algorithms[key].name;
        btn.onclick = () => selectAlgorithm(key);
        algorithmTabs.appendChild(btn);
      });
    }

    function selectAlgorithm(key) {
      currentAlgorithm = key;
      document.querySelectorAll('.tab-btn').forEach((btn, i) => {
        btn.classList.toggle('active', Object.keys(algorithms)[i] === key);
      });
      renderControls();
    }

    function renderControls() {
      algorithmControls.innerHTML = '';
      const algo = algorithms[currentAlgorithm];

      if (algo.needsKey) {
        const keyGroup = document.createElement('div');
        keyGroup.className = 'form-group';
        keyGroup.innerHTML = `
          <label for="keyInput">å¯†é’¥/å‚æ•°</label>
          <input type="text" id="keyInput" placeholder="${currentAlgorithm === 'caesar' ? 'åç§»é‡ï¼ˆå¦‚ï¼š3ï¼‰' : 'å¯†é’¥'}" value="${currentAlgorithm === 'caesar' ? '3' : ''}">
        `;
        algorithmControls.appendChild(keyGroup);
      }

      if (algo.type === 'crypto' && currentAlgorithm === 'aes') {
        const aesModeGroup = document.createElement('div');
        aesModeGroup.className = 'form-group';
        aesModeGroup.innerHTML = `
          <label for="aesMode">AES æ¨¡å¼</label>
          <select id="aesMode">
            <option value="GCM" selected>GCM (Galois/Counter Mode) - æ¨èï¼Œæ”¯æŒè®¤è¯</option>
            <option value="CBC">CBC (Cipher Block Chaining)</option>
            <option value="CTR">CTR (Counter Mode)</option>
            <option value="CFB">CFB (Cipher Feedback)</option>
            <option value="OFB">OFB (Output Feedback)</option>
            <option value="KW">KW (Key Wrap)</option>
          </select>
          <div class="info-text">GCM æœ€å®‰å…¨ï¼ˆæ”¯æŒè®¤è¯ï¼‰ï¼ŒCBC/CTR å…¼å®¹æ€§å¥½</div>
        `;
        algorithmControls.appendChild(aesModeGroup);

        const keyLengthGroup = document.createElement('div');
        keyLengthGroup.className = 'form-group';
        keyLengthGroup.innerHTML = `
          <label for="aesKeyLength">å¯†é’¥é•¿åº¦</label>
          <select id="aesKeyLength">
            <option value="128">128 ä½ (16 å­—èŠ‚) - è¾ƒå¿«</option>
            <option value="192">192 ä½ (24 å­—èŠ‚)</option>
            <option value="256" selected>256 ä½ (32 å­—èŠ‚) - æœ€å®‰å…¨</option>
          </select>
          <div class="info-text">å¯†é’¥é•¿åº¦è¶Šé•¿è¶Šå®‰å…¨ï¼Œä½†åŠ å¯†é€Ÿåº¦ç¨æ…¢</div>
        `;
        algorithmControls.appendChild(keyLengthGroup);

        const saltGroup = document.createElement('div');
        saltGroup.className = 'form-group';
        const saltBtn = document.createElement('button');
        saltBtn.type = 'button';
        saltBtn.className = 'btn';
        saltBtn.id = 'generateSaltBtn';
        saltBtn.textContent = 'ç”Ÿæˆ';
        saltBtn.style.cssText = 'width:auto;padding:12px 20px;font-size:14px';
        saltGroup.innerHTML = `
          <label for="saltInput">ç›å€¼ (Salt)</label>
          <div style="display:flex;gap:8px">
            <input type="text" id="saltInput" placeholder="ç•™ç©ºè‡ªåŠ¨ç”Ÿæˆï¼Œæˆ–è¾“å…¥32ä¸ªHexå­—ç¬¦(16å­—èŠ‚)" style="flex:1">
          </div>
          <div class="info-text">ç›å€¼ç”¨äºå¢å¼ºå¯†é’¥å®‰å…¨æ€§ï¼Œå»ºè®®ä½¿ç”¨16å­—èŠ‚éšæœºå€¼</div>
        `;
        const saltInputContainer = saltGroup.querySelector('div');
        saltInputContainer.appendChild(saltBtn);
        algorithmControls.appendChild(saltGroup);

        const ivGroup = document.createElement('div');
        ivGroup.className = 'form-group';
        const ivBtn = document.createElement('button');
        ivBtn.type = 'button';
        ivBtn.className = 'btn';
        ivBtn.id = 'generateIvBtn';
        ivBtn.textContent = 'ç”Ÿæˆ';
        ivBtn.style.cssText = 'width:auto;padding:12px 20px;font-size:14px';
        ivGroup.innerHTML = `
          <label for="ivInput">åˆå§‹åŒ–å‘é‡ (IV)</label>
          <div style="display:flex;gap:8px">
            <input type="text" id="ivInput" placeholder="ç•™ç©ºè‡ªåŠ¨ç”Ÿæˆï¼Œæˆ–è¾“å…¥Hexå­—ç¬¦ä¸²" style="flex:1">
          </div>
          <div class="info-text">IVç”¨äºç¡®ä¿ç›¸åŒæ˜æ–‡äº§ç”Ÿä¸åŒå¯†æ–‡ï¼ŒGCMæ¨¡å¼12å­—èŠ‚(24ä¸ªHexå­—ç¬¦)ï¼Œå…¶ä»–æ¨¡å¼16å­—èŠ‚(32ä¸ªHexå­—ç¬¦)</div>
        `;
        const ivInputContainer = ivGroup.querySelector('div');
        ivInputContainer.appendChild(ivBtn);
        algorithmControls.appendChild(ivGroup);

        const iterationsGroup = document.createElement('div');
        iterationsGroup.className = 'form-group';
        iterationsGroup.innerHTML = `
          <label for="iterationsInput">PBKDF2 è¿­ä»£æ¬¡æ•°</label>
          <input type="number" id="iterationsInput" value="100000" min="1000" max="10000000" step="1000">
          <div class="info-text">è¿­ä»£æ¬¡æ•°è¶Šå¤šè¶Šå®‰å…¨ä½†è¶Šæ…¢ï¼Œæ¨è100000-1000000</div>
        `;
        algorithmControls.appendChild(iterationsGroup);

        const hashAlgoGroup = document.createElement('div');
        hashAlgoGroup.className = 'form-group';
        hashAlgoGroup.innerHTML = `
          <label for="hashAlgoSelect">PBKDF2 å“ˆå¸Œç®—æ³•</label>
          <select id="hashAlgoSelect">
            <option value="SHA-256" selected>SHA-256 - æ¨è</option>
            <option value="SHA-384">SHA-384</option>
            <option value="SHA-512">SHA-512 - æ›´å®‰å…¨ä½†æ›´æ…¢</option>
          </select>
          <div class="info-text">ç”¨äºPBKDF2å¯†é’¥æ´¾ç”Ÿï¼ŒSHA-256æ˜¯å¹³è¡¡é€‰æ‹©</div>
        `;
        algorithmControls.appendChild(hashAlgoGroup);
      }
    }

    async function process(mode) {
      const input = inputText.value.trim();
      if (!input) {
        showStatus('è¯·è¾“å…¥å†…å®¹', 'error');
        return;
      }

      try {
        const algo = algorithms[currentAlgorithm];
        let result = '';

        if (algo.type === 'encode') {
          result = await handleEncode(currentAlgorithm, input, mode);
        } else if (algo.type === 'hash') {
          result = await handleHash(currentAlgorithm, input);
        } else if (algo.type === 'crypto') {
          const key = document.getElementById('keyInput')?.value || '';
          if (algo.needsKey && !key) {
            showStatus('è¯·è¾“å…¥å¯†é’¥', 'error');
            return;
          }
          const options = {};
          if (currentAlgorithm === 'aes') {
            options.aesMode = document.getElementById('aesMode')?.value || 'GCM';
            options.keyLength = parseInt(document.getElementById('aesKeyLength')?.value || '256');
            options.salt = document.getElementById('saltInput')?.value || '';
            options.iv = document.getElementById('ivInput')?.value || '';
            options.iterations = parseInt(document.getElementById('iterationsInput')?.value || '100000');
            options.hashAlgo = document.getElementById('hashAlgoSelect')?.value || 'SHA-256';
          }
          result = await handleCrypto(currentAlgorithm, input, key, mode, options);
        }

        outputText.textContent = result;
        showStatus(mode === 'encrypt' || mode === 'encode' ? 'åŠ å¯†/ç¼–ç æˆåŠŸ' : 'è§£å¯†/è§£ç æˆåŠŸ', 'success');
      } catch (err) {
        console.error(err);
        showStatus('å¤„ç†å¤±è´¥ï¼š' + err.message, 'error');
        outputText.textContent = '';
      }
    }

    async function handleEncode(algorithm, input, mode) {
      switch (algorithm) {
        case 'base64':
          return mode === 'encode' ? btoa(unescape(encodeURIComponent(input))) : decodeURIComponent(escape(atob(input)));
        case 'url':
          return mode === 'encode' ? encodeURIComponent(input) : decodeURIComponent(input);
        case 'html':
          const div = document.createElement('div');
          if (mode === 'encode') {
            div.textContent = input;
            return div.innerHTML.replace(/"/g, '&quot;').replace(/'/g, '&#39;');
          } else {
            div.innerHTML = input;
            return div.textContent;
          }
        case 'hex':
          if (mode === 'encode') {
            return Array.from(input).map(c => c.charCodeAt(0).toString(16).padStart(2, '0')).join(' ');
          } else {
            // æ”¯æŒç©ºæ ¼åˆ†éš”æˆ–è¿ç»­Hexå­—ç¬¦ä¸²
            const hexStr = input.replace(/\s+/g, '');
            if (hexStr.length % 2 !== 0) {
              throw new Error('Hexå­—ç¬¦ä¸²é•¿åº¦å¿…é¡»æ˜¯å¶æ•°');
            }
            let result = '';
            for (let i = 0; i < hexStr.length; i += 2) {
              const hex = hexStr.substr(i, 2);
              result += String.fromCharCode(parseInt(hex, 16));
            }
            return result;
          }
        case 'unicode':
          if (mode === 'encode') {
            return Array.from(input).map(c => '\\u' + c.charCodeAt(0).toString(16).padStart(4, '0')).join('');
          } else {
            return input.replace(/\\u([0-9a-fA-F]{4})/g, (_, hex) => String.fromCharCode(parseInt(hex, 16)));
          }
        case 'morse':
          const morseCode = {
            'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.', 'F': '..-.', 'G': '--.', 'H': '....',
            'I': '..', 'J': '.---', 'K': '-.-', 'L': '.-..', 'M': '--', 'N': '-.', 'O': '---', 'P': '.--.',
            'Q': '--.-', 'R': '.-.', 'S': '...', 'T': '-', 'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-',
            'Y': '-.--', 'Z': '--..', '0': '-----', '1': '.----', '2': '..---', '3': '...--', '4': '....-',
            '5': '.....', '6': '-....', '7': '--...', '8': '---..', '9': '----.', '.': '.-.-.-', ',': '--..--',
            '?': '..--..', "'": '.----.', '!': '-.-.--', '/': '-..-.', '(': '-.--.', ')': '-.--.-',
            '&': '.-...', ':': '---...', ';': '-.-.-.', '=': '-...-', '+': '.-.-.', '-': '-....-',
            '_': '..--.-', '"': '.-..-.', '$': '...-..-', '@': '.--.-.'
          };
          const reverseMorse = {};
          Object.keys(morseCode).forEach(k => reverseMorse[morseCode[k]] = k);
          if (mode === 'encode') {
            return input.toUpperCase().split('').map(c => morseCode[c] || (c === ' ' ? '/' : c)).join(' ').replace(/  +/g, ' / ');
          } else {
            // å¤„ç†æ‘©æ–¯å¯†ç è§£ç ï¼Œæ”¯æŒ / ä½œä¸ºå•è¯åˆ†éš”ç¬¦
            return input.split(/[\s\/]+/).map(m => {
              if (m === '' || m === '/') return ' ';
              return reverseMorse[m] || m;
            }).join('').replace(/\s+/g, ' ');
          }
        default:
          throw new Error('ä¸æ”¯æŒçš„ç¼–ç ç®—æ³•');
      }
    }

    async function handleHash(algorithm, input) {
      const encoder = new TextEncoder();
      const data = encoder.encode(input);
      let hash;
      switch (algorithm) {
        case 'md5':
          return await md5(input);
        case 'sha1':
          hash = await crypto.subtle.digest('SHA-1', data);
          return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
        case 'sha256':
          hash = await crypto.subtle.digest('SHA-256', data);
          return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
        case 'sha512':
          hash = await crypto.subtle.digest('SHA-512', data);
          return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
        default:
          throw new Error('ä¸æ”¯æŒçš„å“ˆå¸Œç®—æ³•');
      }
    }

    async function md5(str) {
      function md5cycle(x, k) {
        let a = x[0], b = x[1], c = x[2], d = x[3];
        a = ff(a, b, c, d, k[0], 7, -680876936);
        d = ff(d, a, b, c, k[1], 12, -389564586);
        c = ff(c, d, a, b, k[2], 17, 606105819);
        b = ff(b, c, d, a, k[3], 22, -1044525330);
        a = ff(a, b, c, d, k[4], 7, -176418897);
        d = ff(d, a, b, c, k[5], 12, 1200080426);
        c = ff(c, d, a, b, k[6], 17, -1473231341);
        b = ff(b, c, d, a, k[7], 22, -45705983);
        a = ff(a, b, c, d, k[8], 7, 1770035416);
        d = ff(d, a, b, c, k[9], 12, -1958414417);
        c = ff(c, d, a, b, k[10], 17, -42063);
        b = ff(b, c, d, a, k[11], 22, -1990404162);
        a = ff(a, b, c, d, k[12], 7, 1804603682);
        d = ff(d, a, b, c, k[13], 12, -40341101);
        c = ff(c, d, a, b, k[14], 17, -1502002290);
        b = ff(b, c, d, a, k[15], 22, 1236535329);
        a = gg(a, b, c, d, k[1], 5, -165796510);
        d = gg(d, a, b, c, k[6], 9, -1069501632);
        c = gg(c, d, a, b, k[11], 14, 643717713);
        b = gg(b, c, d, a, k[0], 20, -373897302);
        a = gg(a, b, c, d, k[5], 5, -701558691);
        d = gg(d, a, b, c, k[10], 9, 38016083);
        c = gg(c, d, a, b, k[15], 14, -660478335);
        b = gg(b, c, d, a, k[4], 20, -405537848);
        a = gg(a, b, c, d, k[9], 5, 568446438);
        d = gg(d, a, b, c, k[14], 9, -1019803690);
        c = gg(c, d, a, b, k[3], 14, -187363961);
        b = gg(b, c, d, a, k[8], 20, 1163531501);
        a = gg(a, b, c, d, k[13], 5, -1444681467);
        d = gg(d, a, b, c, k[2], 9, -51403784);
        c = gg(c, d, a, b, k[7], 14, 1735328473);
        b = gg(b, c, d, a, k[12], 20, -1926607734);
        a = hh(a, b, c, d, k[5], 4, -378558);
        d = hh(d, a, b, c, k[8], 11, -2022574463);
        c = hh(c, d, a, b, k[11], 16, 1839030562);
        b = hh(b, c, d, a, k[14], 23, -35309556);
        a = hh(a, b, c, d, k[1], 4, -1530992060);
        d = hh(d, a, b, c, k[4], 11, 1272893353);
        c = hh(c, d, a, b, k[7], 16, -155497632);
        b = hh(b, c, d, a, k[10], 23, -1094730640);
        a = hh(a, b, c, d, k[13], 4, 681279174);
        d = hh(d, a, b, c, k[0], 11, -358537222);
        c = hh(c, d, a, b, k[3], 16, -722521979);
        b = hh(b, c, d, a, k[6], 23, 76029189);
        a = hh(a, b, c, d, k[9], 4, -640364487);
        d = hh(d, a, b, c, k[12], 11, -421815835);
        c = hh(c, d, a, b, k[15], 16, 530742520);
        b = hh(b, c, d, a, k[2], 23, -995338651);
        a = ii(a, b, c, d, k[0], 6, -198630844);
        d = ii(d, a, b, c, k[7], 10, 1126891415);
        c = ii(c, d, a, b, k[14], 15, -1416354905);
        b = ii(b, c, d, a, k[5], 21, -57434055);
        a = ii(a, b, c, d, k[12], 6, 1700485571);
        d = ii(d, a, b, c, k[3], 10, -1894986606);
        c = ii(c, d, a, b, k[10], 15, -1051523);
        b = ii(b, c, d, a, k[1], 21, -2054922799);
        a = ii(a, b, c, d, k[8], 6, 1873313359);
        d = ii(d, a, b, c, k[15], 10, -30611744);
        c = ii(c, d, a, b, k[6], 15, -1560198380);
        b = ii(b, c, d, a, k[13], 21, 1309151649);
        a = ii(a, b, c, d, k[4], 6, -145523070);
        d = ii(d, a, b, c, k[11], 10, -1120210379);
        c = ii(c, d, a, b, k[2], 15, 718787259);
        b = ii(b, c, d, a, k[9], 21, -343485551);
        x[0] = add32(a, x[0]);
        x[1] = add32(b, x[1]);
        x[2] = add32(c, x[2]);
        x[3] = add32(d, x[3]);
      }
      function cmn(q, a, b, x, s, t) {
        a = add32(add32(a, q), add32(x, t));
        return add32((a << s) | (a >>> (32 - s)), b);
      }
      function ff(a, b, c, d, x, s, t) {
        return cmn((b & c) | ((~b) & d), a, b, x, s, t);
      }
      function gg(a, b, c, d, x, s, t) {
        return cmn((b & d) | (c & (~d)), a, b, x, s, t);
      }
      function hh(a, b, c, d, x, s, t) {
        return cmn(b ^ c ^ d, a, b, x, s, t);
      }
      function ii(a, b, c, d, x, s, t) {
        return cmn(c ^ (b | (~d)), a, b, x, s, t);
      }
      function add32(a, b) {
        return (a + b) & 0xFFFFFFFF;
      }
      function rhex(n) {
        let s = '', v = '0123456789abcdef';
        for (let j = 0; j <= 3; j++)s += v.charAt((n >> (j * 8 + 4)) & 0x0F) + v.charAt((n >> (j * 8)) & 0x0F);
        return s;
      }
      const x = [];
      let AA, BB, CC, DD, a, b, c, d;
      const S11 = 7, S12 = 12, S13 = 17, S14 = 22;
      const S21 = 5, S22 = 9, S23 = 14, S24 = 20;
      const S31 = 4, S32 = 11, S33 = 16, S34 = 23;
      const S41 = 6, S42 = 10, S43 = 15, S44 = 21;
      str = unescape(encodeURIComponent(str));
      const len = str.length;
      x[len >> 5] |= 0x80 << ((len) % 32);
      x[(((len + 64) >>> 9) << 4) + 14] = len;
      let i, j;
      for (i = 0; i < x.length; i += 16) {
        AA = a = 1732584193;
        BB = b = 271733879;
        CC = c = 1732584194;
        DD = d = 271733880;
        a = ff(a, b, c, d, x[i + 0], S11, 3614090360);
        d = ff(d, a, b, c, x[i + 1], S12, 3905402710);
        c = ff(c, d, a, b, x[i + 2], S13, 606105819);
        b = ff(b, c, d, a, x[i + 3], S14, 3250441966);
        a = ff(a, b, c, d, x[i + 4], S11, 4118548399);
        d = ff(d, a, b, c, x[i + 5], S12, 1200080426);
        c = ff(c, d, a, b, x[i + 6], S13, 2821735955);
        b = ff(b, c, d, a, x[i + 7], S14, 4249261313);
        a = ff(a, b, c, d, x[i + 8], S11, 1770035416);
        d = ff(d, a, b, c, x[i + 9], S12, 2336552879);
        c = ff(c, d, a, b, x[i + 10], S13, 4294925233);
        b = ff(b, c, d, a, x[i + 11], S14, 2304563134);
        a = ff(a, b, c, d, x[i + 12], S11, 1804603682);
        d = ff(d, a, b, c, x[i + 13], S12, 4254626195);
        c = ff(c, d, a, b, x[i + 14], S13, 2792965006);
        b = ff(b, c, d, a, x[i + 15], S14, 1236535329);
        a = gg(a, b, c, d, x[i + 1], S21, 4129170786);
        d = gg(d, a, b, c, x[i + 6], S22, 3225465664);
        c = gg(c, d, a, b, x[i + 11], S23, 643717713);
        b = gg(b, c, d, a, x[i + 0], S24, 3921069994);
        a = gg(a, b, c, d, x[i + 5], S21, 3593408605);
        d = gg(d, a, b, c, x[i + 10], S22, 38016083);
        c = gg(c, d, a, b, x[i + 15], S23, 3634488961);
        b = gg(b, c, d, a, x[i + 4], S24, 3889429448);
        a = gg(a, b, c, d, x[i + 9], S21, 568446438);
        d = gg(d, a, b, c, x[i + 14], S22, 3275163606);
        c = gg(c, d, a, b, x[i + 3], S23, 4107603335);
        b = gg(b, c, d, a, x[i + 8], S24, 1163531501);
        a = gg(a, b, c, d, x[i + 13], S21, 2850285829);
        d = gg(d, a, b, c, x[i + 2], S22, 4243563512);
        c = gg(c, d, a, b, x[i + 7], S23, 1735328473);
        b = gg(b, c, d, a, x[i + 12], S24, 2368359562);
        a = hh(a, b, c, d, x[i + 5], S31, 4294588738);
        d = hh(d, a, b, c, x[i + 8], S32, 2272392833);
        c = hh(c, d, a, b, x[i + 11], S33, 1839030562);
        b = hh(b, c, d, a, x[i + 14], S34, 4259657740);
        a = hh(a, b, c, d, x[i + 1], S31, 2763975236);
        d = hh(d, a, b, c, x[i + 4], S32, 1272893353);
        c = hh(c, d, a, b, x[i + 7], S33, 4139469664);
        b = hh(b, c, d, a, x[i + 10], S34, 3200236656);
        a = hh(a, b, c, d, x[i + 13], S31, 681279174);
        d = hh(d, a, b, c, x[i + 0], S32, 3936430074);
        c = hh(c, d, a, b, x[i + 3], S33, 3572445317);
        b = hh(b, c, d, a, x[i + 6], S34, 76029189);
        a = hh(a, b, c, d, x[i + 9], S31, 3654602809);
        d = hh(d, a, b, c, x[i + 12], S32, 3873151461);
        c = hh(c, d, a, b, x[i + 15], S33, 530742520);
        b = hh(b, c, d, a, x[i + 2], S34, 3299628645);
        a = ii(a, b, c, d, x[i + 0], S41, 4096336452);
        d = ii(d, a, b, c, x[i + 7], S42, 1126891415);
        c = ii(c, d, a, b, x[i + 14], S43, 2878612391);
        b = ii(b, c, d, a, x[i + 5], S44, 4237533241);
        a = ii(a, b, c, d, x[i + 12], S41, 1700485571);
        d = ii(d, a, b, c, x[i + 3], S42, 2399980690);
        c = ii(c, d, a, b, x[i + 10], S43, 4293915773);
        b = ii(b, c, d, a, x[i + 1], S44, 2240044497);
        a = ii(a, b, c, d, x[i + 8], S41, 1873313359);
        d = ii(d, a, b, c, x[i + 15], S42, 4264355552);
        c = ii(c, d, a, b, x[i + 6], S43, 2734768916);
        b = ii(b, c, d, a, x[i + 13], S44, 1309151649);
        a = ii(a, b, c, d, x[i + 4], S41, 4149444226);
        d = ii(d, a, b, c, x[i + 11], S42, 3174756917);
        c = ii(c, d, a, b, x[i + 2], S43, 718787259);
        b = ii(b, c, d, a, x[i + 9], S44, 3951481745);
        a = add32(a, AA);
        b = add32(b, BB);
        c = add32(c, CC);
        d = add32(d, DD);
      }
      return (rhex(a) + rhex(b) + rhex(c) + rhex(d)).toLowerCase();
    }

    async function handleCrypto(algorithm, input, key, mode, options = {}) {
      switch (algorithm) {
        case 'aes':
          const aesMode = options.aesMode || 'GCM';
          const keyLength = options.keyLength || 256;
          const salt = options.salt || '';
          const iv = options.iv || '';
          const iterations = options.iterations || 100000;
          const hashAlgo = options.hashAlgo || 'SHA-256';
          return await aesCrypto(input, key, mode, aesMode, keyLength, salt, iv, iterations, hashAlgo);
        case 'caesar':
          return caesarCipher(input, parseInt(key) || 3, mode);
        default:
          throw new Error('ä¸æ”¯æŒçš„åŠ å¯†ç®—æ³•');
      }
    }

    function hexToBytes(hex) {
      hex = hex.replace(/\s+/g, ''); // ç§»é™¤ç©ºæ ¼
      if (hex.length % 2 !== 0) throw new Error('Hexå­—ç¬¦ä¸²é•¿åº¦å¿…é¡»æ˜¯å¶æ•°');
      const bytes = new Uint8Array(hex.length / 2);
      for (let i = 0; i < hex.length; i += 2) {
        bytes[i / 2] = parseInt(hex.substr(i, 2), 16);
      }
      return bytes;
    }

    function bytesToHex(bytes) {
      return Array.from(bytes).map(b => b.toString(16).padStart(2, '0')).join('');
    }

    async function aesCrypto(text, password, mode, aesMode, keyLength, saltInput, ivInput, iterations, hashAlgo) {
      const encoder = new TextEncoder();
      const decoder = new TextDecoder();

      // ç¡®å®š IV é•¿åº¦å’Œç®—æ³•åç§°ï¼ˆä¸åŒæ¨¡å¼éœ€è¦ä¸åŒé•¿åº¦çš„ IVï¼‰
      let ivLength = 16; // é»˜è®¤ 16 å­—èŠ‚
      let algorithmName;

      if (aesMode === 'GCM') {
        ivLength = 12; // GCM æ¨èä½¿ç”¨ 12 å­—èŠ‚ IV
        algorithmName = 'AES-GCM';
      } else if (aesMode === 'CBC') {
        ivLength = 16; // CBC ä½¿ç”¨ 16 å­—èŠ‚ IV
        algorithmName = 'AES-CBC';
      } else if (aesMode === 'CTR') {
        ivLength = 16; // CTR ä½¿ç”¨ 16 å­—èŠ‚ IV
        algorithmName = 'AES-CTR';
      } else if (aesMode === 'CFB') {
        ivLength = 16; // CFB ä½¿ç”¨ 16 å­—èŠ‚ IV
        algorithmName = 'AES-CFB';
      } else if (aesMode === 'OFB') {
        ivLength = 16; // OFB ä½¿ç”¨ 16 å­—èŠ‚ IV
        algorithmName = 'AES-OFB';
      } else {
        // é»˜è®¤ä½¿ç”¨ GCM
        ivLength = 12;
        algorithmName = 'AES-GCM';
      }

      // å¤„ç†ç›å€¼
      let salt;
      if (mode === 'encrypt') {
        if (saltInput && saltInput.trim()) {
          try {
            salt = hexToBytes(saltInput.trim());
            if (salt.length !== 16) {
              throw new Error('ç›å€¼å¿…é¡»æ˜¯16å­—èŠ‚ï¼ˆ32ä¸ªHexå­—ç¬¦ï¼‰');
            }
          } catch (e) {
            throw new Error('ç›å€¼æ ¼å¼é”™è¯¯ï¼š' + e.message);
          }
        } else {
          salt = crypto.getRandomValues(new Uint8Array(16));
        }
      } else {
        // è§£å¯†æ—¶ä»å¯†æ–‡ä¸­æå–ç›å€¼
        const allData = Uint8Array.from(atob(text), c => c.charCodeAt(0));
        const metadataLen = (allData[0] << 8) | allData[1];
        const metadataStr = decoder.decode(allData.slice(2, 2 + metadataLen));
        const metadata = JSON.parse(metadataStr);
        const dataStart = 2 + metadataLen;
        salt = allData.slice(dataStart, dataStart + metadata.saltLen);
      }

      const keyMaterial = await crypto.subtle.importKey('raw', encoder.encode(password), 'PBKDF2', false, ['deriveBits', 'deriveKey']);

      // åˆ›å»ºå¯†é’¥é…ç½®
      const keyConfig = { name: algorithmName, length: keyLength };

      // éªŒè¯å“ˆå¸Œç®—æ³•
      const validHashAlgos = ['SHA-256', 'SHA-384', 'SHA-512'];
      const hashAlgorithm = validHashAlgos.includes(hashAlgo) ? hashAlgo : 'SHA-256';

      // éªŒè¯è¿­ä»£æ¬¡æ•°
      const validIterations = Math.max(1000, Math.min(10000000, iterations));

      const key = await crypto.subtle.deriveKey(
        { name: 'PBKDF2', salt: salt, iterations: validIterations, hash: hashAlgorithm },
        keyMaterial,
        keyConfig,
        false,
        ['encrypt', 'decrypt']
      );

      if (mode === 'encrypt') {
        let iv = null;
        let encryptParams = {};

        // å¤„ç† IV
        if (ivInput && ivInput.trim()) {
          try {
            iv = hexToBytes(ivInput.trim());
            if (iv.length !== ivLength) {
              throw new Error(`IVå¿…é¡»æ˜¯${ivLength}å­—èŠ‚ï¼ˆ${ivLength * 2}ä¸ªHexå­—ç¬¦ï¼‰`);
            }
          } catch (e) {
            throw new Error('IVæ ¼å¼é”™è¯¯ï¼š' + e.message);
          }
        } else {
          iv = crypto.getRandomValues(new Uint8Array(ivLength));
        }

        if (aesMode === 'GCM') {
          encryptParams = { name: 'AES-GCM', iv: iv };
        } else if (aesMode === 'CBC') {
          encryptParams = { name: 'AES-CBC', iv: iv };
        } else if (aesMode === 'CTR') {
          encryptParams = { name: 'AES-CTR', counter: iv, length: 128 };
        } else if (aesMode === 'CFB') {
          encryptParams = { name: 'AES-CFB', iv: iv };
        } else if (aesMode === 'OFB') {
          encryptParams = { name: 'AES-OFB', iv: iv };
        } else {
          // é»˜è®¤ä½¿ç”¨ GCM
          encryptParams = { name: 'AES-GCM', iv: iv };
        }

        const encrypted = await crypto.subtle.encrypt(encryptParams, key, encoder.encode(text));

        // ç»„åˆ salt + iv + encrypted data
        const ivSize = iv.length;
        const combined = new Uint8Array(salt.length + ivSize + encrypted.byteLength);
        combined.set(salt, 0);
        combined.set(iv, salt.length);
        combined.set(new Uint8Array(encrypted), salt.length + ivSize);

        // æ·»åŠ å…ƒæ•°æ®æ ‡è¯†ï¼ˆsalté•¿åº¦ + ivé•¿åº¦ + æ¨¡å¼ + å¯†é’¥é•¿åº¦ + è¿­ä»£æ¬¡æ•° + å“ˆå¸Œç®—æ³•ï¼‰
        const metadata = {
          saltLen: salt.length,
          ivLen: ivSize,
          mode: aesMode,
          keyLen: keyLength,
          iterations: validIterations,
          hashAlgo: hashAlgorithm
        };
        const metadataStr = JSON.stringify(metadata);
        const metadataBytes = encoder.encode(metadataStr);
        const metadataLen = new Uint8Array(2);
        metadataLen[0] = (metadataBytes.length >> 8) & 0xFF;
        metadataLen[1] = metadataBytes.length & 0xFF;

        const final = new Uint8Array(2 + metadataBytes.length + combined.length);
        final.set(metadataLen, 0);
        final.set(metadataBytes, 2);
        final.set(combined, 2 + metadataBytes.length);

        return btoa(String.fromCharCode(...final));
      } else {
        try {
          // è§£ç å¹¶æå–å…ƒæ•°æ®
          const allData = Uint8Array.from(atob(text), c => c.charCodeAt(0));
          const metadataLen = (allData[0] << 8) | allData[1];
          const metadataStr = decoder.decode(allData.slice(2, 2 + metadataLen));
          const metadata = JSON.parse(metadataStr);
          const dataStart = 2 + metadataLen;

          const salt = allData.slice(dataStart, dataStart + metadata.saltLen);
          const ivStart = dataStart + metadata.saltLen;
          const iv = allData.slice(ivStart, ivStart + metadata.ivLen);
          const encrypted = allData.slice(ivStart + metadata.ivLen);

          const storedMode = metadata.mode || aesMode;
          const storedKeyLen = metadata.keyLen || keyLength;
          const storedIterations = metadata.iterations || validIterations;
          const storedHashAlgo = metadata.hashAlgo || hashAlgorithm;

          // é‡æ–°æ´¾ç”Ÿå¯†é’¥
          const keyConfig = { name: `AES-${storedMode}`, length: storedKeyLen };

          const keyMaterial = await crypto.subtle.importKey('raw', encoder.encode(password), 'PBKDF2', false, ['deriveBits', 'deriveKey']);
          const key = await crypto.subtle.deriveKey(
            { name: 'PBKDF2', salt: salt, iterations: storedIterations, hash: storedHashAlgo },
            keyMaterial,
            keyConfig,
            false,
            ['encrypt', 'decrypt']
          );

          // æ ¹æ®å­˜å‚¨çš„æ¨¡å¼åˆ›å»ºè§£å¯†å‚æ•°
          let decryptParams = {};
          if (storedMode === 'GCM') {
            decryptParams = { name: 'AES-GCM', iv: iv };
          } else if (storedMode === 'CBC') {
            decryptParams = { name: 'AES-CBC', iv: iv };
          } else if (storedMode === 'CTR') {
            decryptParams = { name: 'AES-CTR', counter: iv, length: 128 };
          } else if (storedMode === 'CFB') {
            decryptParams = { name: 'AES-CFB', iv: iv };
          } else if (storedMode === 'OFB') {
            decryptParams = { name: 'AES-OFB', iv: iv };
          } else {
            // é»˜è®¤ä½¿ç”¨ GCM
            decryptParams = { name: 'AES-GCM', iv: iv };
          }

          const decrypted = await crypto.subtle.decrypt(decryptParams, key, encrypted);
          return decoder.decode(decrypted);
        } catch (e) {
          console.error('è§£å¯†é”™è¯¯:', e);
          throw new Error('è§£å¯†å¤±è´¥ï¼Œè¯·æ£€æŸ¥å¯†é’¥ã€æ¨¡å¼å’Œå¯†æ–‡æ˜¯å¦æ­£ç¡®ã€‚é”™è¯¯ï¼š' + e.message);
        }
      }
    }

    function caesarCipher(text, shift, mode) {
      shift = mode === 'decrypt' ? -shift : shift;
      return text.split('').map(char => {
        const code = char.charCodeAt(0);
        if (code >= 65 && code <= 90) {
          return String.fromCharCode(((code - 65 + shift + 26) % 26) + 65);
        } else if (code >= 97 && code <= 122) {
          return String.fromCharCode(((code - 97 + shift + 26) % 26) + 97);
        }
        return char;
      }).join('');
    }

    function clearAll() {
      inputText.value = '';
      outputText.textContent = '';
      showStatus('å·²æ¸…ç©º', 'success');
    }

    function copyResult() {
      const text = outputText.textContent;
      if (!text) {
        showStatus('æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹', 'error');
        return;
      }
      navigator.clipboard.writeText(text).then(() => {
        showStatus('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
      }).catch(() => {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        showStatus('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
      });
    }

    function generateRandomHex(bytes) {
      const random = crypto.getRandomValues(new Uint8Array(bytes));
      return bytesToHex(random);
    }

    function setupEventListeners() {
      // ä½¿ç”¨äº‹ä»¶å§”æ‰˜å¤„ç†åŠ¨æ€ç”Ÿæˆçš„æŒ‰é’®
      document.addEventListener('click', (e) => {
        if (e.target.id === 'generateSaltBtn') {
          e.preventDefault();
          const saltInput = document.getElementById('saltInput');
          if (saltInput) {
            saltInput.value = generateRandomHex(16);
            showStatus('å·²ç”Ÿæˆ16å­—èŠ‚éšæœºç›å€¼', 'success');
          }
        }
        if (e.target.id === 'generateIvBtn') {
          e.preventDefault();
          const ivInput = document.getElementById('ivInput');
          const aesMode = document.getElementById('aesMode')?.value || 'GCM';
          if (ivInput) {
            const ivLength = aesMode === 'GCM' ? 12 : 16;
            ivInput.value = generateRandomHex(ivLength);
            showStatus(`å·²ç”Ÿæˆ${ivLength}å­—èŠ‚éšæœºIV`, 'success');
          }
        }
      });
    }

    encryptBtn.addEventListener('click', () => {
      const algo = algorithms[currentAlgorithm];
      if (algo.type === 'encode') {
        process('encode');
      } else if (algo.type === 'crypto') {
        process('encrypt');
      } else if (algo.type === 'hash') {
        process('hash');
      }
    });

    decryptBtn.addEventListener('click', () => {
      const algo = algorithms[currentAlgorithm];
      if (algo.type === 'encode') {
        process('decode');
      } else if (algo.type === 'crypto') {
        process('decrypt');
      } else {
        showStatus('è¯¥ç®—æ³•ä¸æ”¯æŒè§£å¯†æ“ä½œ', 'error');
      }
    });

    clearBtn.addEventListener('click', clearAll);
    copyBtn.addEventListener('click', copyResult);

    initTabs();
    renderControls();
    setupEventListeners();
  </script>
  <script src="../../assets/js/tools.js"></script>
  <script src="../../assets/js/themes.js"></script>
  <script src="../../assets/js/theme-ui.js"></script>
</body>

</html>